
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>hydpy.core.timetools &#8212; HydPy 4.0a11 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 4.0a11 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydpy.core.timetools</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;This module specifies the handling of dates and periods in *HydPy* projects.</span>

<span class="sd">.. _`Time Coordinate`: http://cfconventions.org/Data/cf-conventions/\</span>
<span class="sd">cf-conventions-1.7/cf-conventions.html#time-coordinate</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># import...</span>
<span class="c1"># ...from standard library</span>
<span class="kn">import</span> <span class="nn">calendar</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">datetime_</span>
<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="o">*</span>
<span class="c1"># ...from third party packages</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="c1"># ...from HydPy</span>
<span class="kn">import</span> <span class="nn">hydpy</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">objecttools</span>

<span class="c1"># The import of `_strptime` is not thread save.  The following call of</span>
<span class="c1"># `strptime` is supposed to prevent possible problems arising from this bug.</span>
<span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;1999&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y&#39;</span><span class="p">)</span>


<span class="n">DateConstrArg</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">PeriodConstrArg</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>


<div class="viewcode-block" id="Date"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date">[docs]</a><span class="k">class</span> <span class="nc">Date</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Handles a single date.</span>

<span class="sd">    We built class the |Date| on top of the Python module |datetime|.</span>
<span class="sd">    In essence, it wraps |datetime.datetime| objects and specialise</span>
<span class="sd">    this general class on the needs of *HydPy* users.</span>

<span class="sd">    |Date| objects can be initialised via |datetime.datetime| objects</span>
<span class="sd">    directly:</span>

<span class="sd">    &gt;&gt;&gt; import datetime</span>
<span class="sd">    &gt;&gt;&gt; date = datetime.datetime(1996, 11, 1, 0, 0, 0)</span>
<span class="sd">    &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">    &gt;&gt;&gt; Date(date)</span>
<span class="sd">    Date(&#39;1996-11-01 00:00:00&#39;)</span>

<span class="sd">    |Date| objects do not store time zone information.  The |Date| object</span>
<span class="sd">    prepared above refers to zero o&#39;clock in the time zone defined by</span>
<span class="sd">    |Options.utcoffset| (UTC+01:00 by default).  When the initialisation</span>
<span class="sd">    argument provides other time zone information, its date information</span>
<span class="sd">    is adjusted, which we show in the following examples, where the</span>
<span class="sd">    prepared |datetime.datetime| objects refer to UTC 00:00 and UTC-01:00:</span>

<span class="sd">    &gt;&gt;&gt; date = datetime.datetime(1996, 11, 1, 0, 0, 0,</span>
<span class="sd">    ...     tzinfo=datetime.timezone(datetime.timedelta(0)))</span>
<span class="sd">    &gt;&gt;&gt; Date(date)</span>
<span class="sd">    Date(&#39;1996-11-01 01:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; date = datetime.datetime(1996, 11, 1, 0, 0, 0,</span>
<span class="sd">    ...     tzinfo=datetime.timezone(datetime.timedelta(hours=-1)))</span>
<span class="sd">    &gt;&gt;&gt; Date(date)</span>
<span class="sd">    Date(&#39;1996-11-01 02:00:00&#39;)</span>

<span class="sd">    One can change |Options.utcoffset|, but this does not affect already</span>
<span class="sd">    existing |Date| objects:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">    &gt;&gt;&gt; pub.options.utcoffset = 0</span>
<span class="sd">    &gt;&gt;&gt; temp = Date(date)</span>
<span class="sd">    &gt;&gt;&gt; temp</span>
<span class="sd">    Date(&#39;1996-11-01 01:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; pub.options.utcoffset = 60</span>
<span class="sd">    &gt;&gt;&gt; temp</span>
<span class="sd">    Date(&#39;1996-11-01 01:00:00&#39;)</span>

<span class="sd">    Class |Date| accepts |str| objects as alternative constructor arguments.</span>
<span class="sd">    These are often more rapidly defined and allow to set the |Date.style|</span>
<span class="sd">    property by the way (see the documentation on method |Date.from_string|</span>
<span class="sd">    for more examples):</span>

<span class="sd">    &gt;&gt;&gt; Date(&#39;1996-11-01&#39;)</span>
<span class="sd">    Date(&#39;1996-11-01 00:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Date(&#39;1996.11.01&#39;)</span>
<span class="sd">    Date(&#39;1996.11.01 00:00:00&#39;)</span>

<span class="sd">    Invalid arguments types result in the following error:</span>

<span class="sd">    &gt;&gt;&gt; Date(1)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: While trying to initialise a `Date` object based on \</span>
<span class="sd">argument `1`, the following error occurred: The supplied argument must \</span>
<span class="sd">be either an instance of `Date`, `datetime.datetime`, or `str`.  \</span>
<span class="sd">The given arguments type is `int`.</span>

<span class="sd">    In contrast to class |datetime.datetime|, class |Date| is mutable:</span>

<span class="sd">    &gt;&gt;&gt; date = Date(&#39;1996-11-01&#39;)</span>
<span class="sd">    &gt;&gt;&gt; date.hour = 12</span>
<span class="sd">    &gt;&gt;&gt; date</span>
<span class="sd">    Date(&#39;1996-11-01 12:00:00&#39;)</span>

<span class="sd">    Unplausible values assigned to property |Date.hour| and its related</span>
<span class="sd">    properties result in error messages like the following:</span>

<span class="sd">    &gt;&gt;&gt; date.hour = 24</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: While trying to change the hour of the current Date object, \</span>
<span class="sd">the following error occurred: hour must be in 0..23</span>

<span class="sd">    You can do some math with |Date| objects.  First, you can add |Period|</span>
<span class="sd">    objects to shift the date:</span>

<span class="sd">    &gt;&gt;&gt; date = Date(&#39;2000.01.01&#39;)</span>
<span class="sd">    &gt;&gt;&gt; date + &#39;1d&#39;</span>
<span class="sd">    Date(&#39;2000.01.02 00:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; date += &#39;12h&#39;</span>
<span class="sd">    &gt;&gt;&gt; date</span>
<span class="sd">    Date(&#39;2000.01.01 12:00:00&#39;)</span>

<span class="sd">    Second, you can subtract both |Period| and other |Date| objects to</span>
<span class="sd">    shift the date or determine the time delta, respectively:</span>

<span class="sd">    &gt;&gt;&gt; date - &#39;1s&#39;</span>
<span class="sd">    Date(&#39;2000.01.01 11:59:59&#39;)</span>
<span class="sd">    &gt;&gt;&gt; date -= &#39;12h&#39;</span>
<span class="sd">    &gt;&gt;&gt; date</span>
<span class="sd">    Date(&#39;2000.01.01 00:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; date - &#39;2000-01-05&#39;</span>
<span class="sd">    Period(&#39;-4d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; &#39;2000.01.01 00:00:30&#39; - date</span>
<span class="sd">    Period(&#39;30s&#39;)</span>

<span class="sd">    To try to subtract objects neither interpretable as a |Date|</span>
<span class="sd">    nor |Period| object results in the following error:</span>

<span class="sd">    &gt;&gt;&gt; date - &#39;1&#39;</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: Object `1` of type `str` cannot be substracted from a \</span>
<span class="sd">`Date` instance.</span>

<span class="sd">    The comparison operators work as expected:</span>

<span class="sd">    &gt;&gt;&gt; d1, d2 = Date(&#39;2000-1-1&#39;), Date(&#39;2001-1-1&#39;)</span>
<span class="sd">    &gt;&gt;&gt; d1 &lt; d2, d1 &lt; &#39;2000-1-1&#39;, &#39;2001-1-2&#39; &lt; d1</span>
<span class="sd">    (True, False, False)</span>
<span class="sd">    &gt;&gt;&gt; d1 &lt;= d2, d1 &lt;= &#39;2000-1-1&#39;, &#39;2001-1-2&#39; &lt;= d1</span>
<span class="sd">    (True, True, False)</span>
<span class="sd">    &gt;&gt;&gt; d1 == d2, d1 == &#39;2000-1-1&#39;, &#39;2001-1-2&#39; == d1, d1 == &#39;1d&#39;</span>
<span class="sd">    (False, True, False, False)</span>
<span class="sd">    &gt;&gt;&gt; d1 != d2, d1 != &#39;2000-1-1&#39;, &#39;2001-1-2&#39; != d1, d1 != &#39;1d&#39;</span>
<span class="sd">    (True, False, True, True)</span>
<span class="sd">    &gt;&gt;&gt; d1 &gt;= d2, d1 &gt;= &#39;2000-1-1&#39;, &#39;2001-1-2&#39; &gt;= d1</span>
<span class="sd">    (False, True, True)</span>
<span class="sd">    &gt;&gt;&gt; d1 &gt; d2, d1 &gt; &#39;2000-1-1&#39;, &#39;2001-1-2&#39; &gt; d1</span>
<span class="sd">    (False, False, True)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># These are the so far accepted date format strings.</span>
    <span class="n">formatstrings</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;os&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y_%m_</span><span class="si">%d</span><span class="s1">_%H_%M_%S&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;iso2&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;iso1&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;din1&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%Y %H:%M:%S&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;din2&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y.%m.</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)])</span>
    <span class="c1"># The first month of the hydrological year (e.g. November in Germany)</span>
    <span class="n">_firstmonth_wateryear</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">_lastformatstring</span> <span class="o">=</span> <span class="s1">&#39;os&#39;</span><span class="p">,</span> <span class="n">formatstrings</span><span class="p">[</span><span class="s1">&#39;os&#39;</span><span class="p">]</span>

    <span class="n">datetime</span><span class="p">:</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">Date</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_date</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The supplied argument must be either an instance of &#39;</span>
                <span class="n">f</span><span class="s1">&#39;`Date`, `datetime.datetime`, or `str`.  The given &#39;</span>
                <span class="n">f</span><span class="s1">&#39;arguments type is `{objecttools.classname(date)}`.&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to initialise a `Date` &#39;</span>
                <span class="n">f</span><span class="s1">&#39;object based on argument `</span><span class="si">{date}</span><span class="s1">`&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Date.from_date"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date.from_date">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_date</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="s1">&#39;Date&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new |Date| object based on another |Date| object and</span>
<span class="sd">        return it.</span>

<span class="sd">        Initialisation from other |Date| objects preserves their</span>
<span class="sd">        |Date.style| information:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date1 = Date(&#39;2000.01.01&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date2 = Date(date1)</span>
<span class="sd">        &gt;&gt;&gt; date1.style = &#39;iso2&#39;</span>
<span class="sd">        &gt;&gt;&gt; date3 = Date.from_date(date1)</span>
<span class="sd">        &gt;&gt;&gt; date2</span>
<span class="sd">        Date(&#39;2000.01.01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date3</span>
<span class="sd">        Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">datetime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Date.from_datetime"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date.from_datetime">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_datetime</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new |Date| object based on a |datetime.datetime| object</span>
<span class="sd">        and return it.</span>

<span class="sd">        Initialisation from |datetime.datetime| does not modify the</span>
<span class="sd">        default |Date.style| information:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; from datetime import datetime, timedelta, timezone</span>
<span class="sd">        &gt;&gt;&gt; Date.from_datetime(datetime(2000, 1, 1))</span>
<span class="sd">        Date(&#39;2000-01-01 00:00:00&#39;)</span>

<span class="sd">        Be aware of the different minimum time resolution of class</span>
<span class="sd">        |datetime.datetime| (microseconds) and class |Date| (seconds):</span>

<span class="sd">        &gt;&gt;&gt; Date.from_datetime(datetime(2000, 1, 1, microsecond=2))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: For `Date` instances, the microsecond must be zero, \</span>
<span class="sd">but for the given `datetime` object it is `2` instead.</span>

<span class="sd">        Due to a different kind of handling time zone information,</span>
<span class="sd">        the time zone awareness of |datetime.datetime| objects is</span>
<span class="sd">        removed (see the main documentation on class |Date| for</span>
<span class="sd">        further information:</span>

<span class="sd">        &gt;&gt;&gt; date = Date.from_datetime(</span>
<span class="sd">        ...     datetime(2000, 11, 1, tzinfo=timezone(timedelta(0))))</span>
<span class="sd">        &gt;&gt;&gt; date</span>
<span class="sd">        Date(&#39;2000-11-01 01:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.datetime</span>
<span class="sd">        datetime.datetime(2000, 11, 1, 1, 0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">date</span><span class="o">.</span><span class="n">microsecond</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;For `Date` instances, the microsecond must be zero, &#39;</span>
                <span class="n">f</span><span class="s1">&#39;but for the given `datetime` object it is &#39;</span>
                <span class="n">f</span><span class="s1">&#39;`</span><span class="si">{date.microsecond:d}</span><span class="s1">` instead.&#39;</span><span class="p">)</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">utcoffset</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">utcoffset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-</span> <span class="n">utcoffset</span> <span class="o">+</span>
                    <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="n">date</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Date.from_string"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date.from_string">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new |Date| object based on a |datetime.datetime| object</span>
<span class="sd">        and return it.</span>

<span class="sd">        The given string needs to match one of the following |Date.style|</span>
<span class="sd">        patterns.</span>

<span class="sd">        The `os` style is applied in text files and folder names and does</span>
<span class="sd">        not include any empty spaces or colons:</span>

<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997_11_01_00_00_00&#39;).style</span>
<span class="sd">        &#39;os&#39;</span>

<span class="sd">        The `iso` styles are more legible and come in two flavours.</span>
<span class="sd">        `iso1` following ISO 8601, and `iso2` (which is the default</span>
<span class="sd">        style) omits the `T` between date and time:</span>

<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997-11-01T00:00:00&#39;).style</span>
<span class="sd">        &#39;iso1&#39;</span>
<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997-11-01 00:00:00&#39;).style</span>
<span class="sd">        &#39;iso2&#39;</span>

<span class="sd">        The `din` styles rely on points instead of hyphens.  The difference</span>
<span class="sd">        between the available flavours lies in the order of the date literals</span>
<span class="sd">        (DIN refers to a German norm):</span>

<span class="sd">        &gt;&gt;&gt; Date(&#39;01.11.1997 00:00:00&#39;).style</span>
<span class="sd">        &#39;din1&#39;</span>
<span class="sd">        &gt;&gt;&gt; Date(&#39;1997.11.01 00:00:00&#39;).style</span>
<span class="sd">        &#39;din2&#39;</span>

<span class="sd">        You are allowed to abbreviate the input strings:</span>

<span class="sd">        &gt;&gt;&gt; for string in (&#39;1996-11-01 00:00:00&#39;,</span>
<span class="sd">        ...                &#39;1996-11-01 00:00&#39;,</span>
<span class="sd">        ...                &#39;1996-11-01 00&#39;,</span>
<span class="sd">        ...                &#39;1996-11-01&#39;):</span>
<span class="sd">        ...     print(Date.from_string(string))</span>
<span class="sd">        1996-11-01 00:00:00</span>
<span class="sd">        1996-11-01 00:00:00</span>
<span class="sd">        1996-11-01 00:00:00</span>
<span class="sd">        1996-11-01 00:00:00</span>

<span class="sd">        You can combine all styles with ISO time zone identifiers:</span>

<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997-11-01T00:00:00Z&#39;)</span>
<span class="sd">        Date(&#39;1997-11-01T01:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997-11-01 00:00:00-11:00&#39;)</span>
<span class="sd">        Date(&#39;1997-11-01 12:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997-11-01 +13&#39;)</span>
<span class="sd">        Date(&#39;1997-10-31 12:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997-11-01 +1330&#39;)</span>
<span class="sd">        Date(&#39;1997-10-31 11:30:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;01.11.1997 00-500&#39;)</span>
<span class="sd">        Date(&#39;01.11.1997 06:00:00&#39;)</span>

<span class="sd">        Poorly formatted date strings result in the following or comparable</span>
<span class="sd">        error messages:</span>

<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997/11/01&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The given string `1997/11/01` does not agree with any \</span>
<span class="sd">of the supported format styles.</span>

<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997-11-01 +0000001&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to apply the time zone offset defined \</span>
<span class="sd">by string `1997-11-01 00:00:00`, the following error occurred: \</span>
<span class="sd">wrong number of offset characters</span>

<span class="sd">        &gt;&gt;&gt; Date.from_string(&#39;1997-11-01 +0X:00&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to apply the time zone offset defined \</span>
<span class="sd">by string `1997-11-01 00:00:00`, the following error occurred: \</span>
<span class="sd">invalid literal for int() with base 10: &#39;0X&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=protected-access</span>
        <span class="c1"># due to pylint issue https://github.com/PyCQA/pylint/issues/1159</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">substring</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_offset</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;style&#39;</span><span class="p">],</span> <span class="n">date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_date</span><span class="p">(</span><span class="n">substring</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_date</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_extract_offset</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="s1">&#39;Z&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s1">&#39;+0000&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;+&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">string</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">string</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">string</span><span class="p">[</span><span class="n">idx</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_extract_date</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span> <span class="n">substring</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">]:</span>
        <span class="n">strptime</span> <span class="o">=</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">style</span><span class="p">,</span> <span class="n">format_</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_lastformatstring</span>
            <span class="k">return</span> <span class="n">style</span><span class="p">,</span> <span class="n">strptime</span><span class="p">(</span><span class="n">substring</span><span class="p">,</span> <span class="n">format_</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">format_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">formatstrings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">datetime</span> <span class="o">=</span> <span class="n">strptime</span><span class="p">(</span><span class="n">substring</span><span class="p">,</span> <span class="n">format_</span><span class="p">)</span>
                        <span class="bp">cls</span><span class="o">.</span><span class="n">_lastformatstring</span> <span class="o">=</span> <span class="n">style</span><span class="p">,</span> <span class="n">format_</span>
                        <span class="k">return</span> <span class="n">style</span><span class="p">,</span> <span class="n">datetime</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="n">format_</span> <span class="o">=</span> <span class="n">format_</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The given string `</span><span class="si">{string}</span><span class="s1">` does not agree &#39;</span>
                <span class="n">f</span><span class="s1">&#39;with any of the supported format styles.&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_modify_date</span><span class="p">(</span><span class="n">date</span><span class="p">:</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">date</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">minutes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span><span class="o">*</span><span class="mi">60</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">minutes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">offset</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">offset</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;wrong number of offset characters&#39;</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span>
                <span class="n">minutes</span><span class="o">=</span><span class="n">factor</span><span class="o">*</span><span class="n">minutes</span><span class="o">-</span><span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">date</span> <span class="o">-</span> <span class="n">delta</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to apply the time zone offset &#39;</span>
                <span class="n">f</span><span class="s1">&#39;defined by string `</span><span class="si">{string}</span><span class="s1">`&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Date.from_array"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date.from_array">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |Date| instance based on date information (year,</span>
<span class="sd">        month, day, hour, minute, second) stored as the first entries of</span>
<span class="sd">        the successive rows of a |numpy.ndarray|.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; import numpy</span>
<span class="sd">        &gt;&gt;&gt; array1d = numpy.array([1992, 10, 8, 15, 15, 42, 999])</span>
<span class="sd">        &gt;&gt;&gt; Date.from_array(array1d)</span>
<span class="sd">        Date(&#39;1992-10-08 15:15:42&#39;)</span>

<span class="sd">        &gt;&gt;&gt; array3d = numpy.zeros((7, 2, 2))</span>
<span class="sd">        &gt;&gt;&gt; array3d[:, 0, 0] = array1d</span>
<span class="sd">        &gt;&gt;&gt; Date.from_array(array3d)</span>
<span class="sd">        Date(&#39;1992-10-08 15:15:42&#39;)</span>

<span class="sd">        .. note::</span>

<span class="sd">           The date defined by the given |numpy.ndarray| cannot</span>
<span class="sd">           include any time zone information and corresponds to</span>
<span class="sd">           |Options.utcoffset|, which defaults to UTC+01:00.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">intarray</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
            <span class="n">intarray</span> <span class="o">=</span> <span class="n">intarray</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_datetime</span><span class="p">(</span><span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="o">*</span><span class="n">intarray</span><span class="p">[:</span><span class="mi">6</span><span class="p">]))</span></div>

<div class="viewcode-block" id="Date.to_array"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date.to_array">[docs]</a>    <span class="k">def</span> <span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a 1-dimensional |numpy| |numpy.ndarray|  with six entries</span>
<span class="sd">        defining the actual date (year, month, day, hour, minute, second).</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; Date(&#39;1992-10-8 15:15:42&#39;).to_array()</span>
<span class="sd">        array([ 1992.,    10.,     8.,    15.,    15.,    42.])</span>

<span class="sd">        .. note::</span>

<span class="sd">           The date defined by the returned |numpy.ndarray| does not</span>
<span class="sd">           include any time zone information and corresponds to</span>
<span class="sd">           |Options.utcoffset|, which defaults to UTC+01:00.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></div>

<div class="viewcode-block" id="Date.from_cfunits"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date.from_cfunits">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_cfunits</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">units</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |Date| object representing the reference date of the</span>
<span class="sd">        given `units` string agreeing with the NetCDF-CF conventions.</span>

<span class="sd">        We took the following example string from the `Time Coordinate`_</span>
<span class="sd">        chapter of the NetCDF-CF conventions documentation (modified).  Note</span>
<span class="sd">        that method |Date.from_cfunits| ignores the first entry (the unit):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; Date.from_cfunits(&#39;seconds since 1992-10-8 15:15:42 -6:00&#39;)</span>
<span class="sd">        Date(&#39;1992-10-08 22:15:42&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_cfunits(&#39; day since 1992-10-8 15:15:00&#39;)</span>
<span class="sd">        Date(&#39;1992-10-08 15:15:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_cfunits(&#39;seconds since 1992-10-8 -6:00&#39;)</span>
<span class="sd">        Date(&#39;1992-10-08 07:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_cfunits(&#39;m since 1992-10-8&#39;)</span>
<span class="sd">        Date(&#39;1992-10-08 00:00:00&#39;)</span>

<span class="sd">        One can also pass the unmodified the example string from</span>
<span class="sd">        `Time Coordinate`_, as long as one omits any decimal fractions</span>
<span class="sd">        of a second different from zero:</span>

<span class="sd">        &gt;&gt;&gt; Date.from_cfunits(&#39;seconds since 1992-10-8 15:15:42.&#39;)</span>
<span class="sd">        Date(&#39;1992-10-08 15:15:42&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_cfunits(&#39;seconds since 1992-10-8 15:15:42.00&#39;)</span>
<span class="sd">        Date(&#39;1992-10-08 15:15:42&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_cfunits(&#39;seconds since 1992-10-8 15:15:42. -6:00&#39;)</span>
<span class="sd">        Date(&#39;1992-10-08 22:15:42&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_cfunits(&#39;seconds since 1992-10-8 15:15:42.0 -6:00&#39;)</span>
<span class="sd">        Date(&#39;1992-10-08 22:15:42&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Date.from_cfunits(&#39;seconds since 1992-10-8 15:15:42.005 -6:00&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to parse the date of the NetCDF-CF &quot;units&quot; \</span>
<span class="sd">string `seconds since 1992-10-8 15:15:42.005 -6:00`, the following error \</span>
<span class="sd">occurred: No other decimal fraction of a second than &quot;0&quot; allowed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="n">units</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;since&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">6</span><span class="p">:]</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">jdx</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">jdx</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">:]):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="n">char</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s1">&#39;No other decimal fraction of a second &#39;</span>
                            <span class="s1">&#39;than &quot;0&quot; allowed.&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jdx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">jdx</span> <span class="o">=</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">jdx</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{string[:idx]}{string[idx+jdx+1:]}</span><span class="s1">&#39;</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to parse the date of the NetCDF-CF &quot;units&quot; &#39;</span>
                <span class="n">f</span><span class="s1">&#39;string `</span><span class="si">{units}</span><span class="s1">`&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Date.to_cfunits"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date.to_cfunits">[docs]</a>    <span class="k">def</span> <span class="nf">to_cfunits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;hours&#39;</span><span class="p">,</span> <span class="n">utcoffset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a `units` string agreeing with the NetCDF-CF conventions.</span>

<span class="sd">        By default, method |Date.to_cfunits| uses `hours` as the time unit</span>
<span class="sd">        and takes the value of |Options.utcoffset| as time zone information:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;1992-10-08 15:15:42&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.to_cfunits()</span>
<span class="sd">        &#39;hours since 1992-10-08 15:15:42 +01:00&#39;</span>

<span class="sd">        You can define arbitrary strings to describe the time unit:</span>

<span class="sd">        &gt;&gt;&gt; date.to_cfunits(unit=&#39;minutes&#39;)</span>
<span class="sd">        &#39;minutes since 1992-10-08 15:15:42 +01:00&#39;</span>

<span class="sd">        For changing the time zone, pass the corresponding offset in minutes:</span>

<span class="sd">        &gt;&gt;&gt; date.to_cfunits(unit=&#39;sec&#39;, utcoffset=-60)</span>
<span class="sd">        &#39;sec since 1992-10-08 13:15:42 -01:00&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">utcoffset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">utcoffset</span> <span class="o">=</span> <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">utcoffset</span>
        <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;iso2&#39;</span><span class="p">,</span> <span class="n">utcoffset</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="n">string</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]))</span>
        <span class="k">return</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{unit}</span><span class="s1"> since </span><span class="si">{string}</span><span class="s1">&#39;</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">style</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Date format style to be applied in printing.</span>

<span class="sd">        Initially, |Date.style| corresponds to the format style of the</span>
<span class="sd">        string used as the initialisation object of a |Date| object:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;01.11.1997 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.style</span>
<span class="sd">        &#39;din1&#39;</span>
<span class="sd">        &gt;&gt;&gt; date</span>
<span class="sd">        Date(&#39;01.11.1997 00:00:00&#39;)</span>

<span class="sd">        However, you are allowed to change it:</span>

<span class="sd">        &gt;&gt;&gt; date.style = &#39;iso1&#39;</span>
<span class="sd">        &gt;&gt;&gt; date</span>
<span class="sd">        Date(&#39;1997-11-01T00:00:00&#39;)</span>

<span class="sd">        The default style is `iso2`:</span>

<span class="sd">        &gt;&gt;&gt; from datetime import datetime</span>
<span class="sd">        &gt;&gt;&gt; date = Date(datetime(2000, 1, 1))</span>
<span class="sd">        &gt;&gt;&gt; date</span>
<span class="sd">        Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.style</span>
<span class="sd">        &#39;iso2&#39;</span>

<span class="sd">        To try to set a non-existing style results in the following</span>
<span class="sd">        error message:</span>

<span class="sd">        &gt;&gt;&gt; date.style = &#39;iso&#39;</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        AttributeError: Date format style `iso` is not available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;iso2&#39;</span><span class="p">)</span>

    <span class="nd">@style</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatstrings</span><span class="p">:</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">style</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;Date format style `</span><span class="si">{style}</span><span class="s1">` is not available.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thing</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Convenience method for `year.fset`, `month.fset`...&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="s1">&#39;minute&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">):</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="n">thing</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to change the </span><span class="si">{thing}</span><span class="s1"> &#39;</span>
                <span class="n">f</span><span class="s1">&#39;of the current Date object&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The actual second.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.second</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; date.second = 30</span>
<span class="sd">        &gt;&gt;&gt; date.second</span>
<span class="sd">        30</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">second</span>

    <span class="nd">@second</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">second</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_thing</span><span class="p">(</span><span class="s1">&#39;second&#39;</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">minute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The actual minute.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.minute</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; date.minute = 30</span>
<span class="sd">        &gt;&gt;&gt; date.minute</span>
<span class="sd">        30</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">minute</span>

    <span class="nd">@minute</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">minute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minute</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_thing</span><span class="p">(</span><span class="s1">&#39;minute&#39;</span><span class="p">,</span> <span class="n">minute</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hour</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The actual hour.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.hour</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; date.hour = 12</span>
<span class="sd">        &gt;&gt;&gt; date.hour</span>
<span class="sd">        12</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">hour</span>

    <span class="nd">@hour</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">hour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hour</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_thing</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="n">hour</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">day</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The actual day.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.day</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; date.day = 15</span>
<span class="sd">        &gt;&gt;&gt; date.day</span>
<span class="sd">        15</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">day</span>

    <span class="nd">@day</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">day</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">day</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_thing</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">month</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The actual month.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.month</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; date.month = 7</span>
<span class="sd">        &gt;&gt;&gt; date.month</span>
<span class="sd">        7</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">month</span>

    <span class="nd">@month</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">month</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">month</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_thing</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">year</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The actual year.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.year</span>
<span class="sd">        2000</span>
<span class="sd">        &gt;&gt;&gt; date.year = 1   # smallest possible value</span>
<span class="sd">        &gt;&gt;&gt; date.year</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; date.year = 9999   # highest possible value</span>
<span class="sd">        &gt;&gt;&gt; date.year</span>
<span class="sd">        9999</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">year</span>

    <span class="nd">@year</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_thing</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">refmonth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The first month of the hydrological year.</span>

<span class="sd">        The default value is 11 (November which is the German reference month):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date1 = Date(&#39;2000-01-01&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date1.refmonth</span>
<span class="sd">        11</span>

<span class="sd">        Setting it, for example, to 10 (October is another typical reference</span>
<span class="sd">        month in different countries) affects all |Date| instances, no</span>
<span class="sd">        matter if already existing of if created afterwards:</span>

<span class="sd">        &gt;&gt;&gt; date2 = Date(&#39;2010-01-01&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date1.refmonth = 10</span>
<span class="sd">        &gt;&gt;&gt; date1.refmonth</span>
<span class="sd">        10</span>
<span class="sd">        &gt;&gt;&gt; date2.refmonth</span>
<span class="sd">        10</span>
<span class="sd">        &gt;&gt;&gt; Date(&#39;2010-01-01&#39;).refmonth</span>
<span class="sd">        10</span>

<span class="sd">        Alternatively, you can pass an appropriate string (the first</span>
<span class="sd">        three characters count):</span>

<span class="sd">        &gt;&gt;&gt; date1.refmonth = &#39;January&#39;</span>
<span class="sd">        &gt;&gt;&gt; date1.refmonth</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; date1.refmonth = &#39;feb&#39;</span>
<span class="sd">        &gt;&gt;&gt; date1.refmonth</span>
<span class="sd">        2</span>

<span class="sd">        Wrong arguments result in the following error messages:</span>

<span class="sd">        &gt;&gt;&gt; date1.refmonth = 0</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The reference month must be a value between one \</span>
<span class="sd">(January) and twelve (December) but `0` is given</span>

<span class="sd">        &gt;&gt;&gt; date1.refmonth = &#39;wrong&#39;</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The given argument `wrong` cannot be interpreted as a month.</span>

<span class="sd">        &gt;&gt;&gt; date1.refmonth = 11</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_firstmonth_wateryear</span>

    <span class="nd">@refmonth</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">refmonth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">refmonth</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">months</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;jan&#39;</span><span class="p">,</span> <span class="s1">&#39;feb&#39;</span><span class="p">,</span> <span class="s1">&#39;mar&#39;</span><span class="p">,</span> <span class="s1">&#39;apr&#39;</span><span class="p">,</span> <span class="s1">&#39;may&#39;</span><span class="p">,</span> <span class="s1">&#39;jun&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;jul&#39;</span><span class="p">,</span> <span class="s1">&#39;aug&#39;</span><span class="p">,</span> <span class="s1">&#39;sew&#39;</span><span class="p">,</span> <span class="s1">&#39;oct&#39;</span><span class="p">,</span> <span class="s1">&#39;nov&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">]</span>
                <span class="n">refmonth</span> <span class="o">=</span> <span class="n">months</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="n">f</span><span class="s1">&#39;The given argument `</span><span class="si">{value}</span><span class="s1">` cannot be &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;interpreted as a month.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">refmonth</span> <span class="o">&lt;</span> <span class="mi">13</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The reference month must be a value between one &#39;</span>
                <span class="n">f</span><span class="s1">&#39;(January) and twelve (December) but `</span><span class="si">{value}</span><span class="s1">` is given&#39;</span><span class="p">)</span>
        <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_firstmonth_wateryear</span> <span class="o">=</span> <span class="n">refmonth</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wateryear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The actual hydrological year according to the selected</span>
<span class="sd">        reference month.</span>

<span class="sd">        Property |Date.refmonth| defaults to November:</span>

<span class="sd">        &gt;&gt;&gt; october = Date(&#39;1996.10.01&#39;)</span>
<span class="sd">        &gt;&gt;&gt; november = Date(&#39;1996.11.01&#39;)</span>
<span class="sd">        &gt;&gt;&gt; october.wateryear</span>
<span class="sd">        1996</span>
<span class="sd">        &gt;&gt;&gt; november.wateryear</span>
<span class="sd">        1997</span>

<span class="sd">        Note that changing |Date.refmonth| affects all |Date| objects:</span>

<span class="sd">        &gt;&gt;&gt; october.refmonth = 10</span>
<span class="sd">        &gt;&gt;&gt; october.wateryear</span>
<span class="sd">        1997</span>
<span class="sd">        &gt;&gt;&gt; november.wateryear</span>
<span class="sd">        1997</span>
<span class="sd">        &gt;&gt;&gt; october.refmonth = &#39;November&#39;</span>
<span class="sd">        &gt;&gt;&gt; october.wateryear</span>
<span class="sd">        1996</span>
<span class="sd">        &gt;&gt;&gt; november.wateryear</span>
<span class="sd">        1997</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_firstmonth_wateryear</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dayofyear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The day of the year as an integer value.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; Date(&#39;2003-03-01&#39;).dayofyear</span>
<span class="sd">        60</span>
<span class="sd">        &gt;&gt;&gt; Date(&#39;2004-03-01&#39;).dayofyear</span>
<span class="sd">        61</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()</span><span class="o">.</span><span class="n">tm_yday</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">leapyear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return whether the actual date falls in a leap year or not.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; Date(&#39;2003-03-01&#39;).leapyear</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; Date(&#39;2004-03-01&#39;).leapyear</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Date(&#39;2000-03-01&#39;).leapyear</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; Date(&#39;2100-03-01&#39;).leapyear</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span>
        <span class="k">return</span> <span class="p">(((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span>
                <span class="p">(((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">100</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">400</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">+</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>
        <span class="n">new</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span>
        <span class="k">return</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">+=</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Determine the period between two dates.&quot;&quot;&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Subtract a period from the actual date.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Period</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">-</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Period</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="o">-</span><span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>
                <span class="n">new</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span>
                <span class="k">return</span> <span class="n">new</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="n">f</span><span class="s1">&#39;Object `</span><span class="si">{other}</span><span class="s1">` of type `{objecttools.classname(other)}` &#39;</span>
            <span class="n">f</span><span class="s1">&#39;cannot be substracted from a `Date` instance.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Period</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">-=</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">&lt;</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">&lt;=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">&gt;=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="n">new</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">from_date</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new</span>

<div class="viewcode-block" id="Date.to_string"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">utcoffset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |str| object, representing the actual date following</span>
<span class="sd">        the given style and the eventually given UTC offset (in minutes).</span>

<span class="sd">        Without any input arguments, the actual |Date.style| is used</span>
<span class="sd">        to return a date string in your local time zone:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;01.11.1997 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.to_string()</span>
<span class="sd">        &#39;01.11.1997 00:00:00&#39;</span>

<span class="sd">        Passing a style string affects the returned |str| object, but</span>
<span class="sd">        not the |Date.style| property:</span>

<span class="sd">        &gt;&gt;&gt; date.style</span>
<span class="sd">        &#39;din1&#39;</span>
<span class="sd">        &gt;&gt;&gt; date.to_string(style=&#39;iso2&#39;)</span>
<span class="sd">        &#39;1997-11-01 00:00:00&#39;</span>
<span class="sd">        &gt;&gt;&gt; date.style</span>
<span class="sd">        &#39;din1&#39;</span>

<span class="sd">        When passing the `utcoffset` in minutes, method |Date.to_string|</span>
<span class="sd">        appends the offset string:</span>

<span class="sd">        &gt;&gt;&gt; date.to_string(style=&#39;iso2&#39;, utcoffset=60)</span>
<span class="sd">        &#39;1997-11-01 00:00:00+01:00&#39;</span>

<span class="sd">        If the given offset does not correspond to your local offset</span>
<span class="sd">        defined by |Options.utcoffset| (which defaults to UTC+01:00),</span>
<span class="sd">        the date string is adapted:</span>

<span class="sd">        &gt;&gt;&gt; date.to_string(style=&#39;iso1&#39;, utcoffset=0)</span>
<span class="sd">        &#39;1997-10-31T23:00:00+00:00&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span>
        <span class="k">if</span> <span class="n">utcoffset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span> <span class="k">if</span> <span class="n">utcoffset</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span>
            <span class="n">hours</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">utcoffset</span> <span class="o">//</span> <span class="mi">60</span><span class="p">)</span>
            <span class="n">minutes</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">utcoffset</span> <span class="o">%</span> <span class="mi">60</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{sign}{hours:02d}</span><span class="s1">:</span><span class="si">{minutes:02d}</span><span class="s1">&#39;</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">utcoffset</span><span class="o">-</span><span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">utcoffset</span>
            <span class="n">date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">+</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formatstrings</span><span class="p">[</span><span class="n">style</span><span class="p">])</span> <span class="o">+</span> <span class="n">string</span></div>

<div class="viewcode-block" id="Date.to_repr"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Date.to_repr">[docs]</a>    <span class="k">def</span> <span class="nf">to_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">utcoffset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Similar as method |Date.to_string|, but returns a proper</span>
<span class="sd">        string representation instead.</span>

<span class="sd">        See method |Date.to_string| for explanations on the following</span>
<span class="sd">        examples:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Date</span>
<span class="sd">        &gt;&gt;&gt; date = Date(&#39;01.11.1997 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; date.to_repr()</span>
<span class="sd">        &quot;Date(&#39;01.11.1997 00:00:00&#39;)&quot;</span>
<span class="sd">        &gt;&gt;&gt; date.to_repr(&#39;iso1&#39;, utcoffset=0)</span>
<span class="sd">        &quot;Date(&#39;1997-10-31T23:00:00+00:00&#39;)&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;Date(&#39;{self.to_string(style, utcoffset)}&#39;)&quot;</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_repr</span><span class="p">()</span></div>


<div class="viewcode-block" id="Period"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Period">[docs]</a><span class="k">class</span> <span class="nc">Period</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Handles a single period.</span>

<span class="sd">    We built the class |Period| on top of the Python module |datetime|.</span>
<span class="sd">    In essence, it wraps |datetime.timedelta| objects and specialises</span>
<span class="sd">    this general class on the needs of *HydPy* users.</span>

<span class="sd">    Be aware of the different minimum time resolution of module |datetime|</span>
<span class="sd">    (microseconds) and module |timetools| (seconds).</span>

<span class="sd">    You can initialise |Period| directly via |datetime.timedelta|</span>
<span class="sd">    objects (see the documentation on method |Period.from_timedelta|</span>
<span class="sd">    for more information):</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">    &gt;&gt;&gt; from datetime import timedelta</span>
<span class="sd">    &gt;&gt;&gt; Period(timedelta(1))</span>
<span class="sd">    Period(&#39;1d&#39;)</span>

<span class="sd">    Alternatively, one can initialise from |str| objects.  These must</span>
<span class="sd">    consist of some characters defining an integer value followed</span>
<span class="sd">    by a single character defining the unit (see the documentation on</span>
<span class="sd">    method |Period.from_timedelta| for more information):</span>

<span class="sd">    &gt;&gt;&gt; Period(&#39;30s&#39;)</span>
<span class="sd">    Period(&#39;30s&#39;)</span>

<span class="sd">    In case you need an &quot;empty&quot; period object, pass nothing or |None|:</span>

<span class="sd">    &gt;&gt;&gt; Period()</span>
<span class="sd">    Period()</span>
<span class="sd">    &gt;&gt;&gt; Period(None)</span>
<span class="sd">    Period()</span>

<span class="sd">    All other types result in the following error:</span>

<span class="sd">    &gt;&gt;&gt; Period(1)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: While trying to initialise a `Period` object based \</span>
<span class="sd">argument `1`, the following error occurred: The supplied argument \</span>
<span class="sd">must be either an instance of `Period`, `datetime.timedelta`, \</span>
<span class="sd">or `str`, but the given type is `int`.</span>

<span class="sd">    Class |Period| supports some mathematical operations.  Depending</span>
<span class="sd">    on the operation, the second operand can be either a number or</span>
<span class="sd">    an object interpretable as a date or period.</span>

<span class="sd">    First, one can add two |Period| objects or add a |Period| object</span>
<span class="sd">    to an object representing a date:</span>

<span class="sd">    &gt;&gt;&gt; period = Period(&#39;1m&#39;)</span>
<span class="sd">    &gt;&gt;&gt; period + &#39;2m&#39;</span>
<span class="sd">    Period(&#39;3m&#39;)</span>
<span class="sd">    &gt;&gt;&gt; &#39;30s&#39; + period</span>
<span class="sd">    Period(&#39;90s&#39;)</span>
<span class="sd">    &gt;&gt;&gt; period += &#39;4m&#39;</span>
<span class="sd">    &gt;&gt;&gt; period</span>
<span class="sd">    Period(&#39;5m&#39;)</span>
<span class="sd">    &gt;&gt;&gt; &#39;2000-01-01&#39; + period</span>
<span class="sd">    Date(&#39;2000-01-01 00:05:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; period + &#39;wrong&#39;</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: Object `wrong` of type `str` cannot be added \</span>
<span class="sd">to a `Period` instance.</span>

<span class="sd">    Subtraction works much alike addition:</span>

<span class="sd">    &gt;&gt;&gt; period = Period(&#39;4d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; period - &#39;1d&#39;</span>
<span class="sd">    Period(&#39;3d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; &#39;1d&#39; - period</span>
<span class="sd">    Period(&#39;-3d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; period -= &#39;2d&#39;</span>
<span class="sd">    &gt;&gt;&gt; period</span>
<span class="sd">    Period(&#39;2d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; &#39;2000-01-10&#39; - period</span>
<span class="sd">    Date(&#39;2000-01-08 00:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; &#39;wrong&#39; - period</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: A `Period` instance cannot be subtracted \</span>
<span class="sd">from object `wrong` of type `str`.</span>

<span class="sd">    Use multiplication with a number to change the length of a |Period| object:</span>

<span class="sd">    &gt;&gt;&gt; period * 2.0</span>
<span class="sd">    Period(&#39;4d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; 0.5 * period</span>
<span class="sd">    Period(&#39;1d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; period *= 1.5</span>
<span class="sd">    &gt;&gt;&gt; period</span>
<span class="sd">    Period(&#39;3d&#39;)</span>

<span class="sd">    Division is possible in combination numbers and objects interpretable</span>
<span class="sd">    as periods:</span>


<span class="sd">    &gt;&gt;&gt; period / 3.0</span>
<span class="sd">    Period(&#39;1d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; period / &#39;36h&#39;</span>
<span class="sd">    2.0</span>
<span class="sd">    &gt;&gt;&gt; &#39;6d&#39; / period</span>
<span class="sd">    2.0</span>
<span class="sd">    &gt;&gt;&gt; period /= 1.5</span>
<span class="sd">    &gt;&gt;&gt; period</span>
<span class="sd">    Period(&#39;2d&#39;)</span>

<span class="sd">    Floor division and calculation of the remainder are also supported:</span>

<span class="sd">    &gt;&gt;&gt; period // &#39;20h&#39;</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; period % &#39;20h&#39;</span>
<span class="sd">    Period(&#39;8h&#39;)</span>
<span class="sd">    &gt;&gt;&gt; &#39;3d&#39; // period</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; timedelta(3) % period</span>
<span class="sd">    Period(&#39;1d&#39;)</span>

<span class="sd">    You can change the sign in the following manners:</span>

<span class="sd">    &gt;&gt;&gt; period = -period</span>
<span class="sd">    &gt;&gt;&gt; period</span>
<span class="sd">    Period(&#39;-2d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; +period</span>
<span class="sd">    Period(&#39;-2d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; abs(period)</span>
<span class="sd">    Period(&#39;2d&#39;)</span>

<span class="sd">    The comparison operators work as expected:</span>

<span class="sd">    &gt;&gt;&gt; p1, p3 = Period(&#39;1d&#39;), Period(&#39;3d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; p1 &lt; &#39;2d&#39;, p1 &lt; &#39;1d&#39;, &#39;2d&#39; &lt; p1</span>
<span class="sd">    (True, False, False)</span>
<span class="sd">    &gt;&gt;&gt; p1 &lt;= p3, p1 &lt;= &#39;1d&#39;, &#39;2d&#39; &lt;= p1</span>
<span class="sd">    (True, True, False)</span>
<span class="sd">    &gt;&gt;&gt; p1 == p3, p1 == &#39;1d&#39;, &#39;2d&#39; == p1, p1 == &#39;2000-01-01&#39;</span>
<span class="sd">    (False, True, False, False)</span>
<span class="sd">    &gt;&gt;&gt; p1 != p3, p1 != &#39;1d&#39;, &#39;2d&#39; != p1, p1 != &#39;2000-01-01&#39;</span>
<span class="sd">    (True, False, True, True)</span>
<span class="sd">    &gt;&gt;&gt; p1 &gt;= p3, p1 &gt;= &#39;1d&#39;, &#39;2d&#39; &gt;= p1</span>
<span class="sd">    (False, True, True)</span>
<span class="sd">    &gt;&gt;&gt; p1 &gt; p3, p1 &gt; &#39;1d&#39;, &#39;2d&#39; &gt; p1</span>
<span class="sd">    (False, False, True)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PeriodConstrArg</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">Period</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_period</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">period</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The supplied argument must be either an instance of &#39;</span>
                <span class="n">f</span><span class="s1">&#39;`Period`, `datetime.timedelta`, or `str`, but the &#39;</span>
                <span class="n">f</span><span class="s1">&#39;given type is `{objecttools.classname(period)}`.&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to initialise a `Period` &#39;</span>
                <span class="n">f</span><span class="s1">&#39;object based argument `</span><span class="si">{period}</span><span class="s1">`&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Period.from_period"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Period.from_period">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_period</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="s1">&#39;Period&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new |Period| object based on another |Period| object and</span>
<span class="sd">        return it.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; p1 = Period(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; p2 = Period.from_period(p1)</span>
<span class="sd">        &gt;&gt;&gt; p2</span>
<span class="sd">        Period(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; p1 *= 2</span>
<span class="sd">        &gt;&gt;&gt; p1</span>
<span class="sd">        Period(&#39;2d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; p2</span>
<span class="sd">        Period(&#39;1d&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;timedelta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timedelta&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Period.from_timedelta"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Period.from_timedelta">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_timedelta</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new |Period| object based on a |datetime.timedelta|</span>
<span class="sd">        object and return it.</span>

<span class="sd">        |datetime.timedelta| objects defining days or seconds are allowed,</span>
<span class="sd">        but |datetime.timedelta| objects defining microseconds are not:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; from datetime import timedelta</span>
<span class="sd">        &gt;&gt;&gt; Period.from_timedelta(timedelta(1, 0))</span>
<span class="sd">        Period(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Period.from_timedelta(timedelta(0, 1))</span>
<span class="sd">        Period(&#39;1s&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Period.from_timedelta(timedelta(0, 0, 1))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: For `Period` instances, microseconds must be zero.  \</span>
<span class="sd">However, for the given `timedelta` object it is `1` instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=protected-access</span>
        <span class="c1"># due to pylint issue https://github.com/PyCQA/pylint/issues/1159</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;timedelta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_timedelta</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_timedelta</span><span class="p">(</span><span class="n">period</span><span class="p">:</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">period</span><span class="o">.</span><span class="n">microseconds</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;For `Period` instances, microseconds must be zero.  &#39;</span>
                <span class="n">f</span><span class="s1">&#39;However, for the given `timedelta` object it is &#39;</span>
                <span class="n">f</span><span class="s1">&#39;`</span><span class="si">{period.microseconds}</span><span class="s1">` instead.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">period</span>

<div class="viewcode-block" id="Period.from_string"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Period.from_string">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new |Period| object based on a |str| object and return it.</span>

<span class="sd">        The string must consist of a leading integer number followed by</span>
<span class="sd">        one of the lower chase characters `s` (seconds), `m` (minutes),</span>
<span class="sd">        `h` (hours), and `d` (days):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; Period.from_string(&#39;30s&#39;)</span>
<span class="sd">        Period(&#39;30s&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Period.from_string(&#39;5m&#39;)</span>
<span class="sd">        Period(&#39;5m&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Period.from_string(&#39;6h&#39;)</span>
<span class="sd">        Period(&#39;6h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Period.from_string(&#39;1d&#39;)</span>
<span class="sd">        Period(&#39;1d&#39;)</span>

<span class="sd">        Ill-defined strings result in the following errors:</span>

<span class="sd">        &gt;&gt;&gt; Period.from_string(&#39;oned&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: All characters of the given period string, \</span>
<span class="sd">except the last one which represents the unit, need to define \</span>
<span class="sd">an integer number.  Instead, these characters are `one`.</span>

<span class="sd">        &gt;&gt;&gt; Period.from_string(&#39;1.5d&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: All characters of the given period string, \</span>
<span class="sd">except the last one which represents the unit, need to define \</span>
<span class="sd">an integer number.  Instead, these characters are `1.5`.</span>

<span class="sd">        &gt;&gt;&gt; Period.from_string(&#39;1D&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The last character of the given period string needs \</span>
<span class="sd">to be either `d` (days), `h` (hours), `m` (minutes),  or `s` (seconds).  \</span>
<span class="sd">Instead, the last character is `D`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;timedelta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_timedelta_from_string</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_timedelta_from_string</span><span class="p">(</span><span class="n">period</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">period</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">number</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;All characters of the given period string, &#39;</span>
                <span class="n">f</span><span class="s1">&#39;except the last one which represents the unit, &#39;</span>
                <span class="n">f</span><span class="s1">&#39;need to define an integer number.  Instead, &#39;</span>
                <span class="n">f</span><span class="s1">&#39;these characters are `</span><span class="si">{period[:-1]}</span><span class="s1">`.&#39;</span><span class="p">)</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">number</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">number</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="n">f</span><span class="s1">&#39;The last character of the given period string needs to &#39;</span>
            <span class="n">f</span><span class="s1">&#39;be either `d` (days), `h` (hours), `m` (minutes),  or `s` &#39;</span>
            <span class="n">f</span><span class="s1">&#39;(seconds).  Instead, the last character is `</span><span class="si">{unit}</span><span class="s1">`.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Period.from_seconds"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Period.from_seconds">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_seconds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">seconds</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new |Period| object based on the given integer number</span>
<span class="sd">        of seconds and return it.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; Period.from_seconds(120)</span>
<span class="sd">        Period(&#39;2m&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">seconds</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Period.from_cfunits"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Period.from_cfunits">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_cfunits</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a |Period| object representing the time unit of the</span>
<span class="sd">        given `units` string agreeing with the NetCDF-CF conventions</span>
<span class="sd">        and return it.</span>

<span class="sd">        We took the following example string from the `Time Coordinate`_</span>
<span class="sd">        chapter of the NetCDF-CF conventions.  Note that the character</span>
<span class="sd">        of the first entry (the actual time unit) is of relevance:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; Period.from_cfunits(&#39;seconds since 1992-10-8 15:15:42.5 -6:00&#39;)</span>
<span class="sd">        Period(&#39;1s&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Period.from_cfunits(&#39; day since 1992-10-8 15:15:00&#39;)</span>
<span class="sd">        Period(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Period.from_cfunits(&#39;m since 1992-10-8&#39;)</span>
<span class="sd">        Period(&#39;1m&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;1{units.strip()[0]}&#39;</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timedelta</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The handled |datetime.timedelta| object.</span>

<span class="sd">        You are allowed to change and delete the handled |datetime.timedelta|</span>
<span class="sd">        object:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; period = Period(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; period.timedelta.days</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; del period.timedelta</span>
<span class="sd">        &gt;&gt;&gt; period.timedelta</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        AttributeError: The Period object does not handle a timedelta \</span>
<span class="sd">object at the moment.</span>
<span class="sd">        &gt;&gt;&gt; from datetime import timedelta</span>
<span class="sd">        &gt;&gt;&gt; period.timedelta = timedelta(1)</span>
<span class="sd">        &gt;&gt;&gt; hasattr(period, &#39;timedelta&#39;)</span>
<span class="sd">        True</span>

<span class="sd">        Property |Period.timedelta| supports the automatic conversion</span>
<span class="sd">        of given |Period| and |str| objects:</span>

<span class="sd">        &gt;&gt;&gt; period.timedelta = Period(&#39;2d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; period.timedelta.days</span>
<span class="sd">        2</span>

<span class="sd">        &gt;&gt;&gt; period.timedelta = &#39;1h&#39;</span>
<span class="sd">        &gt;&gt;&gt; period.timedelta.seconds</span>
<span class="sd">        3600</span>

<span class="sd">        &gt;&gt;&gt; period.timedelta = 1</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        TypeError: The supplied argument must be either an instance of \</span>
<span class="sd">`Period, `datetime.timedelta` or `str`.  The given arguments type is `int`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timedelta</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timedelta&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">timedelta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s1">&#39;The Period object does not handle a &#39;</span>
                <span class="s1">&#39;timedelta object at the moment.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timedelta</span>

    <span class="nd">@timedelta</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">timedelta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PeriodConstrArg</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">Period</span><span class="p">):</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;timedelta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timedelta&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">):</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;timedelta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_timedelta</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;timedelta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_timedelta_from_string</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The supplied argument must be either an instance &#39;</span>
                <span class="n">f</span><span class="s1">&#39;of `Period, `datetime.timedelta` or `str`.  The given &#39;</span>
                <span class="n">f</span><span class="s1">&#39;arguments type is `{objecttools.classname(period)}`.&#39;</span><span class="p">)</span>

    <span class="nd">@timedelta</span><span class="o">.</span><span class="n">deleter</span>
    <span class="k">def</span> <span class="nf">timedelta</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;timedelta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The (most suitable) unit for the current period.</span>

<span class="sd">        |Period.unit| always returns the unit leading to the smallest</span>
<span class="sd">        integer value:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; period = Period(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; period.unit</span>
<span class="sd">        &#39;d&#39;</span>
<span class="sd">        &gt;&gt;&gt; period /= 2</span>
<span class="sd">        &gt;&gt;&gt; period.unit</span>
<span class="sd">        &#39;h&#39;</span>
<span class="sd">        &gt;&gt;&gt; Period(&#39;120s&#39;).unit</span>
<span class="sd">        &#39;m&#39;</span>
<span class="sd">        &gt;&gt;&gt; Period(&#39;90s&#39;).unit</span>
<span class="sd">        &#39;s&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">days</span> <span class="o">%</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;d&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hours</span> <span class="o">%</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;h&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">minutes</span> <span class="o">%</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;m&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;s&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Period length in seconds.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; Period(&#39;2d&#39;).seconds</span>
<span class="sd">        172800.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">minutes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Period length in minutes.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; Period(&#39;2d&#39;).minutes</span>
<span class="sd">        2880.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">60</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hours</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Period length in hours.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; Period(&#39;2d&#39;).hours</span>
<span class="sd">        48.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3600</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">days</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Period length in days.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Period</span>
<span class="sd">        &gt;&gt;&gt; Period(&#39;2d&#39;).days</span>
<span class="sd">        2.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">86400</span>

    <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;timedelta&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add the |Period| object to a |Date| object.&quot;&quot;&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add the |Period| object to another |Period| object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
                <span class="n">new</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">datetime</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>
                <span class="n">new</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">style</span>
                <span class="k">return</span> <span class="n">new</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Period</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">+</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="n">f</span><span class="s1">&#39;Object `</span><span class="si">{other}</span><span class="s1">` of type `{objecttools.classname(other)}` &#39;</span>
            <span class="n">f</span><span class="s1">&#39;cannot be added to a `Period` instance.&#39;</span><span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add the |Period| object to a |Date| object.&quot;&quot;&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add the |Period| object to another |Period| object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">+=</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">-</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Subtract the |Period| object from a |Date| object.&quot;&quot;&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Subtract the |Period| object from another |Period| object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
                <span class="n">new</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">datetime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>
                <span class="n">new</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">style</span>
                <span class="k">return</span> <span class="n">new</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Period</span><span class="p">,</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span>
                    <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="n">f</span><span class="s1">&#39;A `Period` instance cannot be subtracted from object &#39;</span>
            <span class="n">f</span><span class="s1">&#39;`</span><span class="si">{other}</span><span class="s1">` of type `{objecttools.classname(other)}`.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">-=</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">*</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__imul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">*=</span> <span class="n">other</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Divide the |Period| object through another |Period| object.&quot;&quot;&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Divide the |Period| object through a number object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">/</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds</span> <span class="o">/</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">seconds</span>

    <span class="k">def</span> <span class="nf">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">seconds</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds</span>

    <span class="k">def</span> <span class="nf">__itruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">/=</span> <span class="n">other</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">//</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>

    <span class="k">def</span> <span class="nf">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span>

    <span class="k">def</span> <span class="nf">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">%</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Period&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_timedelta</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">&lt;</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">&lt;=</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">==</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">!=</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">&gt;</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">&gt;=</span> <span class="n">Period</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">timedelta</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{self.days:.0f}</span><span class="s1">d&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{self.hours:.0f}</span><span class="s1">h&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{self.minutes:.0f}</span><span class="s1">m&#39;</span>
        <span class="k">return</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{self.seconds:.0f}</span><span class="s1">s&#39;</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;Period(&#39;{str(self)}&#39;)&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;Period()&#39;</span></div>


<div class="viewcode-block" id="Timegrid"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrid">[docs]</a><span class="k">class</span> <span class="nc">Timegrid</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Defines an arbitrary number of equidistant dates via the first date,</span>
<span class="sd">    the last date, and the step size between subsequent dates.</span>

<span class="sd">    In hydrological modelling, input (and output) data are usually only</span>
<span class="sd">    available with a certain resolution, which also determines the possible</span>
<span class="sd">    resolution of the actual simulation.  Class |Timegrid| reflects this</span>
<span class="sd">    situation by representing equidistant dates.</span>

<span class="sd">    To initialise a |Timegrid|, pass its first date, last date and stepsize</span>
<span class="sd">    as |str| objects, |Date| and |Period| objects, or |datetime.datetime|</span>
<span class="sd">    and |datetime.timedelta| objects (combinations are allowed):</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import Date, Period, Timegrid</span>
<span class="sd">    &gt;&gt;&gt; timegrid = Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; timegrid</span>
<span class="sd">    Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">             &#39;2001-01-01 00:00:00&#39;,</span>
<span class="sd">             &#39;1d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; timegrid == Timegrid(</span>
<span class="sd">    ...     Date(&#39;2000-01-01&#39;), Date(&#39;2001-01-01&#39;), Period(&#39;1d&#39;))</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; from datetime import datetime, timedelta</span>
<span class="sd">    &gt;&gt;&gt; timegrid == Timegrid(</span>
<span class="sd">    ...     datetime(2000, 1, 1), datetime(2001, 1, 1), timedelta(1))</span>
<span class="sd">    True</span>

<span class="sd">    Passing unsupported argument types results in errors like the following:</span>

<span class="sd">    &gt;&gt;&gt; Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, 1)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: While trying to prepare a Trimegrid object based on the \</span>
<span class="sd">arguments `2000-01-01`, `2001-01-01`, and `1`, the following error occurred: \</span>
<span class="sd">While trying to initialise a `Period` object based argument `1`, the \</span>
<span class="sd">following error occurred: The supplied argument must be either an instance \</span>
<span class="sd">of `Period`, `datetime.timedelta`, or `str`, but the given type is `int`.</span>

<span class="sd">    You can query indices and the corresponding dates via indexing:</span>

<span class="sd">    &gt;&gt;&gt; timegrid[0]</span>
<span class="sd">    Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; timegrid[5]</span>
<span class="sd">    Date(&#39;2000-01-06 00:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; timegrid[Date(&#39;2000-01-01&#39;)]</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; timegrid[&#39;2000-01-06&#39;]</span>
<span class="sd">    5</span>

<span class="sd">    Indexing beyond the ranges of the actual period is allowed:</span>

<span class="sd">    &gt;&gt;&gt; timegrid[-365]</span>
<span class="sd">    Date(&#39;1999-01-01 00:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; timegrid[&#39;2002-01-01&#39;]</span>
<span class="sd">    731</span>

<span class="sd">    However, dates not precisely matching the defined grid result in</span>
<span class="sd">    the following error:</span>

<span class="sd">    &gt;&gt;&gt; timegrid[&#39;2001-01-01 12:00&#39;]</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: The given date `2001-01-01 12:00:00` is not properly \</span>
<span class="sd">alligned on the indexed timegrid `Timegrid(&#39;2000-01-01 00:00:00&#39;, \</span>
<span class="sd">&#39;2001-01-01 00:00:00&#39;, &#39;1d&#39;)`.</span>

<span class="sd">    You can determine the length of and iterate over |Timegrid| objects:</span>

<span class="sd">    &gt;&gt;&gt; len(timegrid)</span>
<span class="sd">    366</span>
<span class="sd">    &gt;&gt;&gt; for date in timegrid:</span>
<span class="sd">    ...     print(date)   # doctest: +ELLIPSIS</span>
<span class="sd">    2000-01-01 00:00:00</span>
<span class="sd">    2000-01-02 00:00:00</span>
<span class="sd">    ...</span>
<span class="sd">    2000-12-30 00:00:00</span>
<span class="sd">    2000-12-31 00:00:00</span>

<span class="sd">    You can check |Timegrid| instances for equality:</span>

<span class="sd">    &gt;&gt;&gt; timegrid == Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; timegrid != Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; timegrid == Timegrid(&#39;2000-01-02&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; timegrid == Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-02&#39;, &#39;1d&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; timegrid == Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;2d&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; timegrid == 1</span>
<span class="sd">    False</span>

<span class="sd">    Also, you can check if a date or even the whole timegrid lies within a</span>
<span class="sd">    span defined by a |Timegrid| instance (note unaligned dates and time</span>
<span class="sd">    grids with different step sizes are considered unequal):</span>

<span class="sd">    &gt;&gt;&gt; Date(&#39;2000-01-01&#39;) in timegrid</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; &#39;2001-01-01&#39; in timegrid</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; &#39;2000-07-01&#39; in timegrid</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; &#39;1999-12-31&#39; in timegrid</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; &#39;2001-01-02&#39; in timegrid</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; &#39;2001-01-02 12:00&#39; in timegrid</span>
<span class="sd">    False</span>

<span class="sd">    &gt;&gt;&gt; timegrid in Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; timegrid in Timegrid(&#39;1999-01-01&#39;, &#39;2002-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; timegrid in Timegrid(&#39;2000-01-02&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; timegrid in Timegrid(&#39;2000-01-01&#39;, &#39;2000-12-31&#39;, &#39;1d&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; timegrid in Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;2d&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">firstdate</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">,</span>
            <span class="n">lastdate</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">,</span>
            <span class="n">stepsize</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">=</span> <span class="n">firstdate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lastdate</span> <span class="o">=</span> <span class="n">lastdate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">=</span> <span class="n">stepsize</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to prepare a Trimegrid object based on the &#39;</span>
                <span class="n">f</span><span class="s1">&#39;arguments `</span><span class="si">{firstdate}</span><span class="s1">`, `</span><span class="si">{lastdate}</span><span class="s1">`, and `</span><span class="si">{stepsize}</span><span class="s1">`&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">firstdate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Date</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The start date of the relevant period.</span>

<span class="sd">        You can query and alter the value of property |Timegrid.firstdate|</span>
<span class="sd">        (call method |Timegrid.verify| afterwards to make sure the |Timegrid|</span>
<span class="sd">        object did not become ill-defined):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid</span>
<span class="sd">        &gt;&gt;&gt; timegrid = Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrid.firstdate</span>
<span class="sd">        Date(&#39;2000-01-01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrid.firstdate += &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrid</span>
<span class="sd">        Timegrid(&#39;2000-01-02 00:00:00&#39;,</span>
<span class="sd">                 &#39;2001-01-01 00:00:00&#39;,</span>
<span class="sd">                 &#39;1d&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;firstdate&#39;</span><span class="p">]</span>

    <span class="nd">@firstdate</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">firstdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">firstdate</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">):</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;firstdate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="n">firstdate</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lastdate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Date</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The end date of the relevant period.</span>

<span class="sd">        You can query and alter the value of property |Timegrid.lastdate|</span>
<span class="sd">        (call method |Timegrid.verify| afterwards to make sure the |Timegrid|</span>
<span class="sd">        object did not become ill-defined):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid</span>
<span class="sd">        &gt;&gt;&gt; timegrid = Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrid.lastdate</span>
<span class="sd">        Date(&#39;2001-01-01 00:00:00&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrid.lastdate += &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrid</span>
<span class="sd">        Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                 &#39;2001-01-02 00:00:00&#39;,</span>
<span class="sd">                 &#39;1d&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;lastdate&#39;</span><span class="p">]</span>

    <span class="nd">@lastdate</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lastdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lastdate</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;lastdate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="n">lastdate</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stepsize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Period</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The time-series data and simulation step size.</span>

<span class="sd">        You can query and alter the value of property |Timegrid.stepsize|</span>
<span class="sd">        (call method |Timegrid.verify| afterwards to make sure the |Timegrid|</span>
<span class="sd">        object did not become ill-defined):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid</span>
<span class="sd">        &gt;&gt;&gt; timegrid = Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrid.stepsize</span>
<span class="sd">        Period(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrid.stepsize += &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrid</span>
<span class="sd">        Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                 &#39;2001-01-01 00:00:00&#39;,</span>
<span class="sd">                 &#39;2d&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;stepsize&#39;</span><span class="p">]</span>

    <span class="nd">@stepsize</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">stepsize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;stepsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Period</span><span class="p">(</span><span class="n">stepsize</span><span class="p">)</span>

<div class="viewcode-block" id="Timegrid.from_array"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrid.from_array">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Timegrid&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a |Timegrid| instance based on information stored in</span>
<span class="sd">        the first 13 rows of a |numpy.ndarray| object and return it.</span>

<span class="sd">        In *HydPy*, external time series files do define the time-related</span>
<span class="sd">        reference of their data on their own.  For the |numpy| `npy`</span>
<span class="sd">        binary format, we achieve this by reserving the first six</span>
<span class="sd">        entries for the first date of the period, the next six entries</span>
<span class="sd">        for the last date of the period, and the last entry for the step</span>
<span class="sd">        size (in seconds):</span>

<span class="sd">        &gt;&gt;&gt; from numpy import array</span>
<span class="sd">        &gt;&gt;&gt; array_ = array([2000, 1, 1, 0, 0, 0,    # first date</span>
<span class="sd">        ...                 2000, 1, 1, 7, 0, 0,    # second date</span>
<span class="sd">        ...                 3600,                   # step size (in seconds)</span>
<span class="sd">        ...                 1, 2, 3, 4, 5, 6, 7])   # data</span>

<span class="sd">        Use method |Timegrid.from_array| to extract the time information:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid</span>
<span class="sd">        &gt;&gt;&gt; timegrid = Timegrid.from_array(array_)</span>
<span class="sd">        &gt;&gt;&gt; timegrid</span>
<span class="sd">        Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                 &#39;2000-01-01 07:00:00&#39;,</span>
<span class="sd">                 &#39;1h&#39;)</span>

<span class="sd">        Too little information results in the following error message:</span>

<span class="sd">        &gt;&gt;&gt; Timegrid.from_array(array_[:12])</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        IndexError: To define a Timegrid instance via an array, 13 numbers \</span>
<span class="sd">are required, but the given array consist of 12 entries/rows only.</span>

<span class="sd">        The inverse method |Timegrid.to_array| creates a new |numpy|</span>
<span class="sd">        |numpy.ndarray| based on the current |Timegrid| object:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(timegrid.to_array())</span>
<span class="sd">        2000.0, 1.0, 1.0, 0.0, 0.0, 0.0, 2000.0, 1.0, 1.0, 7.0, 0.0, 0.0, 3600.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Date</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="p">[:</span><span class="mi">6</span><span class="p">]),</span>
                       <span class="n">Date</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">12</span><span class="p">]),</span>
                       <span class="n">Period</span><span class="o">.</span><span class="n">from_seconds</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;To define a Timegrid instance via an array, 13 &#39;</span>
                <span class="n">f</span><span class="s1">&#39;numbers are required, but the given array &#39;</span>
                <span class="n">f</span><span class="s1">&#39;consist of {len(array)} entries/rows only.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Timegrid.to_array"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrid.to_array">[docs]</a>    <span class="k">def</span> <span class="nf">to_array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a 1-dimensional |numpy| |numpy.ndarray| storing the</span>
<span class="sd">        information of the actual |Timegrid| object.</span>

<span class="sd">        See the documentation on method |Timegrid.from_array| for more</span>
<span class="sd">        information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">values</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
        <span class="n">values</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastdate</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
        <span class="n">values</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span><span class="o">.</span><span class="n">seconds</span>
        <span class="k">return</span> <span class="n">values</span></div>

<div class="viewcode-block" id="Timegrid.from_timepoints"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrid.from_timepoints">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_timepoints</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">timepoints</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span>
            <span class="n">refdate</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">,</span>
            <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;hours&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Timegrid&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |Timegrid| object representing the given starting</span>
<span class="sd">        `timepoints` related to the given `refdate`.</span>

<span class="sd">        The following examples are identical with the ones of method</span>
<span class="sd">        |Timegrid.to_timepoints| but reversed.</span>

<span class="sd">        At least two given time points must be increasing and</span>
<span class="sd">        equidistant.  By default, they are assumed to be the hours</span>
<span class="sd">        elapsed since the given reference date:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid</span>
<span class="sd">        &gt;&gt;&gt; Timegrid.from_timepoints(</span>
<span class="sd">        ...     [0.0, 6.0, 12.0, 18.0], &#39;01.01.2000&#39;)</span>
<span class="sd">        Timegrid(&#39;01.01.2000 00:00:00&#39;,</span>
<span class="sd">                 &#39;02.01.2000 00:00:00&#39;,</span>
<span class="sd">                 &#39;6h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Timegrid.from_timepoints(</span>
<span class="sd">        ...     [24.0, 30.0, 36.0, 42.0], &#39;1999-12-31&#39;)</span>
<span class="sd">        Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                 &#39;2000-01-02 00:00:00&#39;,</span>
<span class="sd">                 &#39;6h&#39;)</span>

<span class="sd">        You can pass other time units (`days` or `min`) explicitly</span>
<span class="sd">        (only the first character counts):</span>

<span class="sd">        &gt;&gt;&gt; Timegrid.from_timepoints(</span>
<span class="sd">        ...     [0.0, 0.25, 0.5, 0.75], &#39;01.01.2000&#39;, unit=&#39;d&#39;)</span>
<span class="sd">        Timegrid(&#39;01.01.2000 00:00:00&#39;,</span>
<span class="sd">                 &#39;02.01.2000 00:00:00&#39;,</span>
<span class="sd">                 &#39;6h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Timegrid.from_timepoints(</span>
<span class="sd">        ...     [1.0, 1.25, 1.5, 1.75], &#39;1999-12-31&#39;, unit=&#39;day&#39;)</span>
<span class="sd">        Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                 &#39;2000-01-02 00:00:00&#39;,</span>
<span class="sd">                 &#39;6h&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">refdate</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="n">refdate</span><span class="p">)</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_cfunits</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">timepoints</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timepoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">firstdate</span> <span class="o">=</span> <span class="n">refdate</span><span class="o">+</span><span class="n">timepoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">unit</span>
        <span class="n">lastdate</span> <span class="o">=</span> <span class="n">refdate</span><span class="o">+</span><span class="p">(</span><span class="n">timepoints</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span><span class="o">*</span><span class="n">unit</span>
        <span class="n">stepsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">lastdate</span><span class="o">-</span><span class="n">firstdate</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">timepoints</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">firstdate</span><span class="p">,</span> <span class="n">lastdate</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">)</span></div>

<div class="viewcode-block" id="Timegrid.to_timepoints"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrid.to_timepoints">[docs]</a>    <span class="k">def</span> <span class="nf">to_timepoints</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;hours&#39;</span><span class="p">,</span>
            <span class="n">offset</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">PeriodConstrArg</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |numpy.ndarray| representing the starting time points</span>
<span class="sd">        of the |Timegrid| object.</span>

<span class="sd">        The following examples are identical with the ones of method</span>
<span class="sd">        |Timegrid.from_timepoints| but reversed.</span>

<span class="sd">        By default, method |Timegrid.to_timepoints| returns the time</span>
<span class="sd">        points in hours:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid</span>
<span class="sd">        &gt;&gt;&gt; timegrid = Timegrid(&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;6h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrid.to_timepoints()</span>
<span class="sd">        array([  0.,   6.,  12.,  18.])</span>

<span class="sd">        You can define other time units (`days` or `min`) (only the first</span>
<span class="sd">        character counts):</span>

<span class="sd">        &gt;&gt;&gt; timegrid.to_timepoints(unit=&#39;d&#39;)</span>
<span class="sd">        array([ 0.  ,  0.25,  0.5 ,  0.75])</span>

<span class="sd">        Additionally, one can pass an `offset` that must be of type |int|</span>
<span class="sd">        or a valid |Period| initialisation argument:</span>

<span class="sd">        &gt;&gt;&gt; timegrid.to_timepoints(offset=24)</span>
<span class="sd">        array([ 24.,  30.,  36.,  42.])</span>
<span class="sd">        &gt;&gt;&gt; timegrid.to_timepoints(offset=&#39;1d&#39;)</span>
<span class="sd">        array([ 24.,  30.,  36.,  42.])</span>
<span class="sd">        &gt;&gt;&gt; timegrid.to_timepoints(unit=&#39;day&#39;, offset=&#39;1d&#39;)</span>
<span class="sd">        array([ 1.  ,  1.25,  1.5 ,  1.75])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">Period</span><span class="o">.</span><span class="n">from_cfunits</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">Period</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span><span class="o">/</span><span class="n">unit</span>
        <span class="n">step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span><span class="o">/</span><span class="n">unit</span>
        <span class="n">nmb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">variable</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">offset</span><span class="o">+</span><span class="n">step</span><span class="o">*</span><span class="p">(</span><span class="n">nmb</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">nmb</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">variable</span></div>

<div class="viewcode-block" id="Timegrid.array2series"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrid.array2series">[docs]</a>    <span class="k">def</span> <span class="nf">array2series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Prefix the information of the actual |Timegrid| object to the</span>
<span class="sd">        given array and return it.</span>

<span class="sd">        The |Timegrid| information is available in the first thirteen values</span>
<span class="sd">        of the first axis of the returned series (see the documentation</span>
<span class="sd">        on the method |Timegrid.from_array|).</span>

<span class="sd">        To show how method |Timegrid.array2series| works, we first apply</span>
<span class="sd">        it on a simple list containing numbers:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid</span>
<span class="sd">        &gt;&gt;&gt; timegrid = Timegrid(&#39;2000-11-01 00:00&#39;, &#39;2000-11-01 04:00&#39;, &#39;1h&#39;)</span>
<span class="sd">        &gt;&gt;&gt; series = timegrid.array2series([1, 2, 3.5, &#39;5.0&#39;])</span>

<span class="sd">        The first six entries contain the first date of the timegrid (year,</span>
<span class="sd">        month, day, hour, minute, second):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import round_</span>
<span class="sd">        &gt;&gt;&gt; round_(series[:6])</span>
<span class="sd">        2000.0, 11.0, 1.0, 0.0, 0.0, 0.0</span>

<span class="sd">        The six subsequent entries contain the last date:</span>

<span class="sd">        &gt;&gt;&gt; round_(series[6:12])</span>
<span class="sd">        2000.0, 11.0, 1.0, 4.0, 0.0, 0.0</span>

<span class="sd">        The thirteens value is the step size in seconds:</span>

<span class="sd">        &gt;&gt;&gt; round_(series[12])</span>
<span class="sd">        3600.0</span>

<span class="sd">        The last four value are the ones of the given vector:</span>

<span class="sd">        &gt;&gt;&gt; round_(series[-4:])</span>
<span class="sd">        1.0, 2.0, 3.5, 5.0</span>

<span class="sd">        The given array can have an arbitrary number of dimensions:</span>

<span class="sd">        &gt;&gt;&gt; import numpy</span>
<span class="sd">        &gt;&gt;&gt; array = numpy.eye(4)</span>
<span class="sd">        &gt;&gt;&gt; series = timegrid.array2series(array)</span>

<span class="sd">        Now the timegrid information is stored in the first column:</span>

<span class="sd">        &gt;&gt;&gt; round_(series[:13, 0])</span>
<span class="sd">        2000.0, 11.0, 1.0, 0.0, 0.0, 0.0, 2000.0, 11.0, 1.0, 4.0, 0.0, 0.0, \</span>
<span class="sd">3600.0</span>

<span class="sd">        All other columns of the first thirteen rows contain |numpy.nan|</span>
<span class="sd">        values:</span>

<span class="sd">        &gt;&gt;&gt; round_(series[12, :])</span>
<span class="sd">        3600.0, nan, nan, nan</span>

<span class="sd">        The original values are available in the last four rows:</span>

<span class="sd">        &gt;&gt;&gt; round_(series[13, :])</span>
<span class="sd">        1.0, 0.0, 0.0, 0.0</span>

<span class="sd">        Inappropriate array objects result in error messages like</span>
<span class="sd">        the following:</span>

<span class="sd">        &gt;&gt;&gt; timegrid.array2series([[1, 2], [3]])</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to prefix timegrid information to the given \</span>
<span class="sd">array, the following error occurred: setting an array element with a sequence.</span>

<span class="sd">        The following error occurs when the given array does not fit to</span>
<span class="sd">        the defined time grid.</span>

<span class="sd">        &gt;&gt;&gt; timegrid.array2series([[1, 2], [3, 4]])</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: When converting an array to a sequence, the lengths of \</span>
<span class="sd">the timegrid and the given array must be equal, but the length of the \</span>
<span class="sd">timegrid object is `4` and the length of the array object is `2`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="s1">&#39;While trying to prefix timegrid information to the &#39;</span>
                <span class="s1">&#39;given array&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;When converting an array to a sequence, the lengths of the &#39;</span>
                <span class="n">f</span><span class="s1">&#39;timegrid and the given array must be equal, but the length &#39;</span>
                <span class="n">f</span><span class="s1">&#39;of the timegrid object is `{len(self)}` and the length of &#39;</span>
                <span class="n">f</span><span class="s1">&#39;the array object is `{len(array)}`.&#39;</span><span class="p">)</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">13</span>
        <span class="n">series</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">slices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]</span>
        <span class="n">subshape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">series</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
            <span class="n">slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">subshape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">series</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">slices</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">subshape</span><span class="p">)</span>
        <span class="n">series</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span> <span class="o">=</span> <span class="n">array</span>
        <span class="k">return</span> <span class="n">series</span></div>

<div class="viewcode-block" id="Timegrid.verify"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrid.verify">[docs]</a>    <span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Raise a |ValueError| if the dates or the step size of the</span>
<span class="sd">        |Timegrid| object are currently inconsistent.</span>

<span class="sd">        Method |Timegrid.verify| is called at the end of the initialisation</span>
<span class="sd">        of a new |Timegrid| object automatically:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid</span>
<span class="sd">        &gt;&gt;&gt; Timegrid(&#39;2001-01-01&#39;, &#39;2000-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to prepare a Trimegrid object based on the \</span>
<span class="sd">arguments `2001-01-01`, `2000-01-01`, and `1d`, the following error occurred: \</span>
<span class="sd">The temporal sequence of the first date (`2001-01-01 00:00:00`) and the last \</span>
<span class="sd">date (`2000-01-01 00:00:00`) is inconsistent.</span>

<span class="sd">        However, the same does not hold when changing property</span>
<span class="sd">        |Timegrid.firstdate|, |Timegrid.lastdate|, or |Timegrid.stepsize|:</span>

<span class="sd">        &gt;&gt;&gt; timegrid = Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrid.stepsize = &#39;4d&#39;</span>

<span class="sd">        When in doubt, call method |Timegrid.verify| manually:</span>

<span class="sd">        &gt;&gt;&gt; timegrid.verify()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The interval between the first date \</span>
<span class="sd">(`2000-01-01 00:00:00`) and the last date (`2001-01-01 00:00:00`) is \</span>
<span class="sd">`366d`, which is not an integral multiple of the step size `4d`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastdate</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The temporal sequence of the first date (`</span><span class="si">{self.firstdate}</span><span class="s1">`) &#39;</span>
                <span class="n">f</span><span class="s1">&#39;and the last date (`</span><span class="si">{self.lastdate}</span><span class="s1">`) is inconsistent.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lastdate</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The interval between the first date (`</span><span class="si">{self.firstdate}</span><span class="s1">`) &#39;</span>
                <span class="n">f</span><span class="s1">&#39;and the last date (`</span><span class="si">{self.lastdate}</span><span class="s1">`) is &#39;</span>
                <span class="n">f</span><span class="s1">&#39;`{self.lastdate-self.firstdate}`, which is not an &#39;</span>
                <span class="n">f</span><span class="s1">&#39;integral multiple of the step size `</span><span class="si">{self.stepsize}</span><span class="s1">`.&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">lastdate</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span><span class="p">))</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Date</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the date corresponding to the given index value.&quot;&quot;&quot;</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">DateConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the index value corresponding to the given date.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">+</span> <span class="n">key</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">%</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The given date `</span><span class="si">{key}</span><span class="s1">` is not properly alligned on &#39;</span>
                <span class="n">f</span><span class="s1">&#39;the indexed timegrid `</span><span class="si">{self}</span><span class="s1">`.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Date</span><span class="p">]:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span>
        <span class="n">last_dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastdate</span><span class="o">.</span><span class="n">datetime</span>
        <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span><span class="o">.</span><span class="n">timedelta</span>
        <span class="n">from_datetime</span> <span class="o">=</span> <span class="n">Date</span><span class="o">.</span><span class="n">from_datetime</span>
        <span class="k">while</span> <span class="n">dt</span> <span class="o">&lt;</span> <span class="n">last_dt</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">from_datetime</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">td</span>

    <span class="k">def</span> <span class="nf">_containsdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">Date</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">&lt;=</span> <span class="n">date</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastdate</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span>
                <span class="p">((</span><span class="n">date</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_containstimegrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timegrid</span><span class="p">:</span> <span class="s1">&#39;Timegrid&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_containsdate</span><span class="p">(</span><span class="n">timegrid</span><span class="o">.</span><span class="n">firstdate</span><span class="p">)</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_containsdate</span><span class="p">(</span><span class="n">timegrid</span><span class="o">.</span><span class="n">lastdate</span><span class="p">)</span> <span class="ow">and</span>
                <span class="p">(</span><span class="n">timegrid</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DateConstrArg</span><span class="p">,</span> <span class="s1">&#39;Timegrid&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Timegrid</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_containstimegrid</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_containsdate</span><span class="p">(</span><span class="n">Date</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">firstdate</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lastdate</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">lastdate</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">stepsize</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignrepr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">flatten_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Timegrid.assignrepr"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrid.assignrepr">[docs]</a>    <span class="k">def</span> <span class="nf">assignrepr</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">style</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">utcoffset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |repr| string with a prefixed assignment.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid</span>
<span class="sd">        &gt;&gt;&gt; timegrid = Timegrid(&#39;1996-11-01 00:00:00&#39;,</span>
<span class="sd">        ...                     &#39;1997-11-01 00:00:00&#39;,</span>
<span class="sd">        ...                     &#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print(timegrid.assignrepr(prefix=&#39;timegrid = &#39;))</span>
<span class="sd">        timegrid = Timegrid(&#39;1996-11-01 00:00:00&#39;,</span>
<span class="sd">                            &#39;1997-11-01 00:00:00&#39;,</span>
<span class="sd">                            &#39;1d&#39;)</span>

<span class="sd">        &gt;&gt;&gt; print(timegrid.assignrepr(</span>
<span class="sd">        ...     prefix=&#39;&#39;, style=&#39;iso1&#39;, utcoffset=120))</span>
<span class="sd">        Timegrid(&#39;1996-11-01T01:00:00+02:00&#39;,</span>
<span class="sd">                 &#39;1997-11-01T01:00:00+02:00&#39;,</span>
<span class="sd">                 &#39;1d&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">skip</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">9</span>
        <span class="n">blanks</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">skip</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{prefix}</span><span class="s2">Timegrid(&#39;&quot;</span>
                <span class="n">f</span><span class="s2">&quot;{self.firstdate.to_string(style, utcoffset)}&#39;,</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">f</span><span class="s2">&quot;</span><span class="si">{blanks}</span><span class="s2">&#39;{self.lastdate.to_string(style, utcoffset)}&#39;,</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">f</span><span class="s2">&quot;</span><span class="si">{blanks}</span><span class="s2">&#39;{str(self.stepsize)}&#39;)&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Timegrids"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrids">[docs]</a><span class="k">class</span> <span class="nc">Timegrids</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Handles both the &quot;initialisation&quot; and the &quot;simulation&quot; |Timegrid|</span>
<span class="sd">    object of a *HydPy* project.</span>

<span class="sd">    The HydPy framework distinguishes two &quot;time frames&quot;, one associated</span>
<span class="sd">    with the initialisation period (`init`) and one associated with the</span>
<span class="sd">    actual simulation period (`sim`).  These time frames are represented</span>
<span class="sd">    by two different |Timegrid| objects, which are both handled by a</span>
<span class="sd">    single |Timegrids| object.</span>

<span class="sd">    There is usually only one |Timegrids| object required within a</span>
<span class="sd">    *HydPy* project available as attribute `timegrids` of module |pub|.</span>
<span class="sd">    You have to create such an object at the beginning of your workflow.</span>

<span class="sd">    In many cases, one wants to perform simulations covering the whole</span>
<span class="sd">    initialisation period.  Then you can pass a single |Timegrid|</span>
<span class="sd">    instance to the constructor of class |Timegrids|:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import Timegrid, Timegrids</span>
<span class="sd">    &gt;&gt;&gt; timegrids = Timegrids(Timegrid(</span>
<span class="sd">    ...     &#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;))</span>
<span class="sd">    &gt;&gt;&gt; print(timegrids)</span>
<span class="sd">    Timegrids(Timegrid(&#39;2000-01-01 00:00:00&#39;, &#39;2001-01-01 00:00:00&#39;, &#39;1d&#39;))</span>

<span class="sd">    An even shorter approach is to pass the arguments of the</span>
<span class="sd">    |Timegrid| constructor directly:</span>

<span class="sd">    &gt;&gt;&gt; timegrids == Timegrids(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">    True</span>

<span class="sd">    Also, you can pass another |Timegrids| object:</span>

<span class="sd">    &gt;&gt;&gt; timegrids == Timegrids(timegrids)</span>
<span class="sd">    True</span>

<span class="sd">    To define a simulation time grid different from the initialisation</span>
<span class="sd">    time grid, pass them as two individual |Timegrid| objects:</span>

<span class="sd">    &gt;&gt;&gt; timegrids = Timegrids(</span>
<span class="sd">    ...     Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;),</span>
<span class="sd">    ...     Timegrid(&#39;2000-01-01&#39;, &#39;2000-07-01&#39;, &#39;1d&#39;))</span>
<span class="sd">    &gt;&gt;&gt; timegrids</span>
<span class="sd">    Timegrids(Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                       &#39;2001-01-01 00:00:00&#39;,</span>
<span class="sd">                       &#39;1d&#39;),</span>
<span class="sd">              Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                       &#39;2000-07-01 00:00:00&#39;,</span>
<span class="sd">                       &#39;1d&#39;))</span>
<span class="sd">    &gt;&gt;&gt; timegrids.init</span>
<span class="sd">    Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">             &#39;2001-01-01 00:00:00&#39;,</span>
<span class="sd">             &#39;1d&#39;)</span>
<span class="sd">    &gt;&gt;&gt; timegrids.sim</span>
<span class="sd">    Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">             &#39;2000-07-01 00:00:00&#39;,</span>
<span class="sd">             &#39;1d&#39;)</span>

<span class="sd">    Wrong arguments should result in understandable error messages:</span>

<span class="sd">    &gt;&gt;&gt; Timegrids(1, 2, 3, 4)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: While trying to define a new Timegrids object based on \</span>
<span class="sd">arguments `1, 2, 3, and 4`, the following error occurred: Initialising \</span>
<span class="sd">`Timegrids` objects requires one, two, or three arguments but `4` are given.</span>

<span class="sd">    &gt;&gt;&gt; Timegrids(&#39;wrong&#39;)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: While trying to define a new Timegrids object based on \</span>
<span class="sd">arguments `wrong`, the following error occurred: When passing a single \</span>
<span class="sd">argument to the constructor of class `Timegrids`, the argument must be \</span>
<span class="sd">a `Timegrid` or a `Timegrids` object, but a `str` is given.</span>

<span class="sd">    &gt;&gt;&gt; Timegrids(&#39;very&#39;, &#39;wrong&#39;)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: While trying to define a new Timegrids object based on \</span>
<span class="sd">arguments `very and wrong`, the following error occurred: When passing \</span>
<span class="sd">two arguments to the constructor of class `Timegrids`, both argument \</span>
<span class="sd">must be `Timegrid` object, but the first one is of type `str`.</span>

<span class="sd">    Two |Timegrids| objects are equal if both the respective initialisation</span>
<span class="sd">    and simulation periods are equal:</span>

<span class="sd">    &gt;&gt;&gt; timegrids == Timegrids(</span>
<span class="sd">    ...     Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;),</span>
<span class="sd">    ...     Timegrid(&#39;2000-01-01&#39;, &#39;2000-07-01&#39;, &#39;1d&#39;))</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; timegrids == Timegrids(</span>
<span class="sd">    ...     Timegrid(&#39;1999-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;),</span>
<span class="sd">    ...     Timegrid(&#39;2000-01-01&#39;, &#39;2000-07-01&#39;, &#39;1d&#39;))</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; timegrids == Timegrids(</span>
<span class="sd">    ...     Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;),</span>
<span class="sd">    ...     Timegrid(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;))</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; timegrids == Date(&#39;2000-01-01&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Timegrid</span><span class="p">,</span> <span class="n">DateConstrArg</span><span class="p">,</span> <span class="n">PeriodConstrArg</span><span class="p">]):</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Timegrids</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nmbargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">nmbargs</span> <span class="ow">or</span> <span class="n">nmbargs</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="n">f</span><span class="s1">&#39;Initialising `Timegrids` objects requires one, two, &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;or three arguments but `</span><span class="si">{nmbargs}</span><span class="s1">` are given.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nmbargs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Timegrids</span><span class="p">):</span>
                    <span class="k">pass</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Timegrid</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sim</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="n">f</span><span class="s1">&#39;When passing a single argument to the constructor &#39;</span>
                        <span class="n">f</span><span class="s1">&#39;of class `Timegrids`, the argument must be a &#39;</span>
                        <span class="n">f</span><span class="s1">&#39;`Timegrid` or a `Timegrids` object, but a &#39;</span>
                        <span class="n">f</span><span class="s1">&#39;`{objecttools.classname(args[0])}` is given.&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">nmbargs</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Timegrid</span><span class="p">):</span>
                        <span class="n">number</span> <span class="o">=</span> <span class="s1">&#39;second&#39;</span> <span class="k">if</span> <span class="n">idx</span> <span class="k">else</span> <span class="s1">&#39;first&#39;</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                            <span class="n">f</span><span class="s1">&#39;When passing two arguments to the constructor &#39;</span>
                            <span class="n">f</span><span class="s1">&#39;of class `Timegrids`, both argument must be &#39;</span>
                            <span class="n">f</span><span class="s1">&#39;`Timegrid` object, but the </span><span class="si">{number}</span><span class="s1"> one is of &#39;</span>
                            <span class="n">f</span><span class="s1">&#39;type `{objecttools.classname(args[0])}`.&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">nmbargs</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="n">Timegrid</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim</span> <span class="o">=</span> <span class="n">Timegrid</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to define a new Timegrids object based on &#39;</span>
                <span class="n">f</span><span class="s1">&#39;arguments `{objecttools.enumeration(args)}`&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stepsize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Period</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Stepsize of all handled |Timegrid| objects.</span>

<span class="sd">        You can change the (the identical) |Timegrid.stepsize| of all</span>
<span class="sd">        handled |Timegrid| objects at once:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrids</span>
<span class="sd">        &gt;&gt;&gt; timegrids = Timegrids(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrids.sim.lastdate = &#39;2000-02-01&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrids</span>
<span class="sd">        Timegrids(Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                           &#39;2001-01-01 00:00:00&#39;,</span>
<span class="sd">                           &#39;1d&#39;),</span>
<span class="sd">                  Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                           &#39;2000-02-01 00:00:00&#39;,</span>
<span class="sd">                           &#39;1d&#39;))</span>

<span class="sd">        &gt;&gt;&gt; timegrids.stepsize</span>
<span class="sd">        Period(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrids.stepsize = &#39;1h&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrids</span>
<span class="sd">        Timegrids(Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                           &#39;2001-01-01 00:00:00&#39;,</span>
<span class="sd">                           &#39;1h&#39;),</span>
<span class="sd">                  Timegrid(&#39;2000-01-01 00:00:00&#39;,</span>
<span class="sd">                           &#39;2000-02-01 00:00:00&#39;,</span>
<span class="sd">                           &#39;1h&#39;))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">stepsize</span>

    <span class="nd">@stepsize</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">stepsize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">=</span> <span class="n">Period</span><span class="p">(</span><span class="n">stepsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">=</span> <span class="n">Period</span><span class="p">(</span><span class="n">stepsize</span><span class="p">)</span>

<div class="viewcode-block" id="Timegrids.verify"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrids.verify">[docs]</a>    <span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Raise a |ValueError| if the different |Timegrid| objects are</span>
<span class="sd">        inconsistent.</span>

<span class="sd">        Method |Timegrids.verify| is called at the end of the initialisation</span>
<span class="sd">        of a new |Timegrids| object automatically:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrid, Timegrids</span>
<span class="sd">        &gt;&gt;&gt; Timegrids(</span>
<span class="sd">        ...     Timegrid(&#39;2001-01-01&#39;, &#39;2002-01-01&#39;, &#39;1d&#39;),</span>
<span class="sd">        ...     Timegrid(&#39;2000-01-01&#39;, &#39;2002-01-01&#39;, &#39;1d&#39;))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to define a new Timegrids object based \</span>
<span class="sd">on arguments `Timegrid(&#39;2001-01-01 00:00:00&#39;, &#39;2002-01-01 00:00:00&#39;, &#39;1d&#39;) \</span>
<span class="sd">and Timegrid(&#39;2000-01-01 00:00:00&#39;, &#39;2002-01-01 00:00:00&#39;, &#39;1d&#39;)`, the \</span>
<span class="sd">following error occurred: The first date of the initialisation period \</span>
<span class="sd">(`2001-01-01 00:00:00`) must not be later than the first date of the \</span>
<span class="sd">simulation period (`2000-01-01 00:00:00`).</span>

<span class="sd">        However, the same does not hold when one changes the initialisation</span>
<span class="sd">        or the simulation time grid later:</span>

<span class="sd">        &gt;&gt;&gt; timegrids = Timegrids(</span>
<span class="sd">        ...     Timegrid(&#39;2001-01-01&#39;, &#39;2002-01-01&#39;, &#39;1d&#39;),</span>
<span class="sd">        ...     Timegrid(&#39;2001-01-01&#39;, &#39;2002-01-01&#39;, &#39;1d&#39;))</span>
<span class="sd">        &gt;&gt;&gt; timegrids.sim.lastdate = &#39;2003-01-01&#39;</span>

<span class="sd">        When in doubt, call method |Timegrids.verify| manually:</span>

<span class="sd">        &gt;&gt;&gt; timegrids.verify()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The last date of the initialisation period \</span>
<span class="sd">(`2002-01-01 00:00:00`) must not be earlier than the last date \</span>
<span class="sd">of the simulation period (`2003-01-01 00:00:00`).</span>

<span class="sd">        Besides both tests explained by the above error messages, method</span>
<span class="sd">        |Timegrids.verify| checks for an equal step size of both</span>
<span class="sd">        |Timegrid| objects and their proper alignment:</span>

<span class="sd">        &gt;&gt;&gt; timegrids.sim.lastdate = &#39;2002-01-01&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrids.sim.stepsize = &#39;5d&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrids.verify()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The initialisation stepsize (`1d`) must be identical \</span>
<span class="sd">with the simulation stepsize (`5d`).</span>

<span class="sd">        &gt;&gt;&gt; timegrids.sim = Timegrid(</span>
<span class="sd">        ...     &#39;2001-01-01 12:00&#39;, &#39;2001-12-31 12:00&#39;, &#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrids.verify()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The simulation time grid `Timegrid(&#39;2001-01-01 12:00:00&#39;, \</span>
<span class="sd">&#39;2001-12-31 12:00:00&#39;, &#39;1d&#39;)` is not properly alligned on the initialisation \</span>
<span class="sd">time grid `Timegrid(&#39;2001-01-01 00:00:00&#39;, &#39;2002-01-01 00:00:00&#39;, &#39;1d&#39;)`.</span>

<span class="sd">        Additionally, the method |Timegrids.verify| calls the</span>
<span class="sd">        verification methods of both |Timegrid| objects:</span>

<span class="sd">        &gt;&gt;&gt; timegrids.sim.stepsize = &#39;3d&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrids.verify()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to verify the simulation time grid \</span>
<span class="sd">`Timegrid(&#39;2001-01-01 00:00:00&#39;, &#39;2002-01-01 00:00:00&#39;, &#39;1d&#39;)`, \</span>
<span class="sd">the following error occurred: The interval between the first date \</span>
<span class="sd">(`2001-01-01 12:00:00`) and the last date (`2001-12-31 12:00:00`) \</span>
<span class="sd">is `364d`, which is not an integral multiple of the step size `3d`.</span>

<span class="sd">        &gt;&gt;&gt; timegrids.init.stepsize = &#39;3d&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrids.verify()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to verify the initialisation time grid \</span>
<span class="sd">`Timegrid(&#39;2001-01-01 00:00:00&#39;, &#39;2002-01-01 00:00:00&#39;, &#39;3d&#39;)`, \</span>
<span class="sd">the following error occurred: The interval between the first date \</span>
<span class="sd">(`2001-01-01 00:00:00`) and the last date (`2002-01-01 00:00:00`) \</span>
<span class="sd">is `365d`, which is not an integral multiple of the step size `3d`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to verify the initialisation &#39;</span>
                <span class="n">f</span><span class="s1">&#39;time grid `</span><span class="si">{self.init}</span><span class="s1">`&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to verify the simulation &#39;</span>
                <span class="n">f</span><span class="s1">&#39;time grid `</span><span class="si">{self.init}</span><span class="s1">`&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">firstdate</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The first date of the initialisation period &#39;</span>
                <span class="n">f</span><span class="s1">&#39;(`</span><span class="si">{self.init.firstdate}</span><span class="s1">`) must not be later &#39;</span>
                <span class="n">f</span><span class="s1">&#39;than the first date of the simulation period &#39;</span>
                <span class="n">f</span><span class="s1">&#39;(`</span><span class="si">{self.sim.firstdate}</span><span class="s1">`).&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">lastdate</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">lastdate</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The last date of the initialisation period &#39;</span>
                <span class="n">f</span><span class="s1">&#39;(`</span><span class="si">{self.init.lastdate}</span><span class="s1">`) must not be earlier &#39;</span>
                <span class="n">f</span><span class="s1">&#39;than the last date of the simulation period &#39;</span>
                <span class="n">f</span><span class="s1">&#39;(`</span><span class="si">{self.sim.lastdate}</span><span class="s1">`).&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">stepsize</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The initialisation stepsize (`</span><span class="si">{self.init.stepsize}</span><span class="s1">`) &#39;</span>
                <span class="n">f</span><span class="s1">&#39;must be identical with the simulation stepsize &#39;</span>
                <span class="n">f</span><span class="s1">&#39;(`</span><span class="si">{self.sim.stepsize}</span><span class="s1">`).&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">firstdate</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The simulation time grid `</span><span class="si">{self.sim}</span><span class="s1">` is not properly &#39;</span>
                <span class="n">f</span><span class="s1">&#39;alligned on the initialisation time grid `</span><span class="si">{self.init}</span><span class="s1">`.&#39;</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">simindices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;A tuple containing the start and end index of the simulation period</span>
<span class="sd">        regarding the initialisation period.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrids</span>
<span class="sd">        &gt;&gt;&gt; timegrids = Timegrids(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrids.simindices</span>
<span class="sd">        (0, 366)</span>
<span class="sd">        &gt;&gt;&gt; timegrids.sim.firstdate = &#39;2000-01-11&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrids.sim.lastdate = &#39;2000-02-01&#39;</span>
<span class="sd">        &gt;&gt;&gt; timegrids.simindices</span>
<span class="sd">        (10, 31)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">firstdate</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">lastdate</span><span class="p">]</span>

<div class="viewcode-block" id="Timegrids.qfactor"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrids.qfactor">[docs]</a>    <span class="k">def</span> <span class="nf">qfactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">area</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the factor for converting `mm/stepsize` to `m/s` for</span>
<span class="sd">        a reference area, given in `km`.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrids, round_</span>
<span class="sd">        &gt;&gt;&gt; timegrids = Timegrids(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1s&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrids.qfactor(1.0)</span>
<span class="sd">        1000.0</span>
<span class="sd">        &gt;&gt;&gt; timegrids.stepsize = &#39;2d&#39;</span>
<span class="sd">        &gt;&gt;&gt; round_(timegrids.qfactor(2.0))</span>
<span class="sd">        0.011574</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">area</span> <span class="o">*</span> <span class="mf">1000.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span><span class="o">.</span><span class="n">seconds</span></div>

<div class="viewcode-block" id="Timegrids.parfactor"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrids.parfactor">[docs]</a>    <span class="k">def</span> <span class="nf">parfactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">:</span> <span class="n">PeriodConstrArg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the factor for adjusting time-dependent parameter values</span>
<span class="sd">        to the actual simulation step size (the given `stepsize` must be</span>
<span class="sd">        related to the original parameter values).</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Timegrids</span>
<span class="sd">        &gt;&gt;&gt; timegrids = Timegrids(&#39;2000-01-01&#39;, &#39;2001-01-01&#39;, &#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; timegrids.parfactor(&#39;1d&#39;)</span>
<span class="sd">        1.0</span>
<span class="sd">        &gt;&gt;&gt; timegrids.parfactor(&#39;1h&#39;)</span>
<span class="sd">        24.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">/</span> <span class="n">Period</span><span class="p">(</span><span class="n">stepsize</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">init</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">init</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">sim</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignrepr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Timegrids.assignrepr"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.Timegrids.assignrepr">[docs]</a>    <span class="k">def</span> <span class="nf">assignrepr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |repr| string with a prefixed assignment.&quot;&quot;&quot;</span>
        <span class="n">caller</span> <span class="o">=</span> <span class="s1">&#39;Timegrids(&#39;</span>
        <span class="n">blanks</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">caller</span><span class="p">))</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{prefix}{caller}</span><span class="s1">&#39;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;{self.init.assignrepr(prefix)},&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{self.sim.assignrepr(blanks)},&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">flatten_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="TOY"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.TOY">[docs]</a><span class="k">class</span> <span class="nc">TOY</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Time of year handler.</span>

<span class="sd">    |TOY| objects are used to define certain things that are true for a</span>
<span class="sd">    specific time point in each year.  The smallest supported time unit is</span>
<span class="sd">    seconds.</span>

<span class="sd">    For initialisation, one usually passes a string defining the month,</span>
<span class="sd">    the day, the hour, the minute and the second in the mentioned order</span>
<span class="sd">    and separated by single underscores:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy.core.timetools import Date, TOY</span>
<span class="sd">    &gt;&gt;&gt; t = TOY(&#39;3_13_23_33_43&#39;)</span>
<span class="sd">    &gt;&gt;&gt; t.month</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; t.day</span>
<span class="sd">    13</span>
<span class="sd">    &gt;&gt;&gt; t.hour</span>
<span class="sd">    23</span>
<span class="sd">    &gt;&gt;&gt; t.minute</span>
<span class="sd">    33</span>
<span class="sd">    &gt;&gt;&gt; t.second</span>
<span class="sd">    43</span>

<span class="sd">    If a lower precision is required, one can shorten the string, which</span>
<span class="sd">    implicitly sets the omitted property to the lowest possible value:</span>

<span class="sd">    &gt;&gt;&gt; TOY(&#39;3_13_23_33&#39;)</span>
<span class="sd">    TOY(&#39;3_13_23_33_0&#39;)</span>

<span class="sd">    The most extreme example is to pass no string at all:</span>

<span class="sd">    &gt;&gt;&gt; TOY()</span>
<span class="sd">    TOY(&#39;1_1_0_0_0&#39;)</span>

<span class="sd">    One can prefix some information to the string, which is useful when the</span>
<span class="sd">    string is to be used as a valid variable name somewhere else:</span>

<span class="sd">    &gt;&gt;&gt; TOY(&#39;something_3_13_23_33_2&#39;)</span>
<span class="sd">    TOY(&#39;3_13_23_33_2&#39;)</span>

<span class="sd">    As one can see, we lose the prefixed information in the printed string</span>
<span class="sd">    representation.  Instead, applying &quot;str&quot; returns a string with a</span>
<span class="sd">    standard prefix:</span>

<span class="sd">    &gt;&gt;&gt; str(TOY(&#39;something_3_13_23_33_2&#39;))</span>
<span class="sd">    &#39;toy_3_13_23_33_2&#39;</span>

<span class="sd">    Alternatively, one can use a |Date| object as an initialisation</span>
<span class="sd">    argument, omitting the year:</span>

<span class="sd">    &gt;&gt;&gt; TOY(Date(&#39;2001.02.03 04:05:06&#39;))</span>
<span class="sd">    TOY(&#39;2_3_4_5_6&#39;)</span>

<span class="sd">    Ill-defined constructor arguments result in error messages like</span>
<span class="sd">    the following:</span>

<span class="sd">    &gt;&gt;&gt; TOY(&#39;2_30_4_5_6&#39;)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: While trying to initialise a TOY object based on argument \</span>
<span class="sd">`value `2_30_4_5_6` of type `str`, the following error occurred: While \</span>
<span class="sd">trying to retrieve the day, the following error occurred: The value of \</span>
<span class="sd">property `day` of the actual TOY (time of year) object must lie within \</span>
<span class="sd">the range `(1, 29)`, as the month has already been set to `2`, but the \</span>
<span class="sd">given value is `30`.</span>

<span class="sd">    It is only allowed to modify the mentioned properties, not to define new</span>
<span class="sd">    ones:</span>

<span class="sd">    &gt;&gt;&gt; t.microsecond = 53</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    AttributeError: TOY (time of year) objects only allow to set the \</span>
<span class="sd">properties month, day, hour, minute, and second, but `microsecond` is given.</span>

<span class="sd">    You can pass any objects convertible to integers:</span>

<span class="sd">    &gt;&gt;&gt; t.second = &#39;53&#39;</span>
<span class="sd">    &gt;&gt;&gt; t.second</span>
<span class="sd">    53</span>

<span class="sd">    Unconvertible objects cause the following error:</span>

<span class="sd">    &gt;&gt;&gt; t.second = &#39;fiftythree&#39;</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: For TOY (time of year) objects, all properties must be of \</span>
<span class="sd">type `int`, but the value `fiftythree` of type `str` given for property \</span>
<span class="sd">`second` cannot be converted to `int`.</span>

<span class="sd">    Additionally, given values are checked to lie within a suitable range:</span>

<span class="sd">    &gt;&gt;&gt; t.second = 60</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: The value of property `second` of TOY (time of year) \</span>
<span class="sd">objects must lie within the range `(0, 59)`, but the given value is `60`.</span>

<span class="sd">    Note that the allowed values for `month` and `day` depend on each other,</span>
<span class="sd">    which is why the order one defines them might be of importance.  So, if</span>
<span class="sd">    January is predefined, one can set day to the 31st:</span>

<span class="sd">    &gt;&gt;&gt; t.month = 1</span>
<span class="sd">    &gt;&gt;&gt; t.day = 31</span>

<span class="sd">    Afterwards, one cannot directly change the month to April:</span>

<span class="sd">    &gt;&gt;&gt; t.month = 4</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: The value of property `month` of the actual TOY \</span>
<span class="sd">(time of year) object must not be the given value `4`, as the day \</span>
<span class="sd">has already been set to `31`.</span>

<span class="sd">    First set `day` to a smaller value and then change `month`:</span>

<span class="sd">    &gt;&gt;&gt; t.day = 30</span>
<span class="sd">    &gt;&gt;&gt; t.month = 4</span>

<span class="sd">    It is possible to compare two |TOY| instances:</span>

<span class="sd">    &gt;&gt;&gt; t1, t2 = TOY(&#39;1&#39;), TOY(&#39;2&#39;)</span>
<span class="sd">    &gt;&gt;&gt; t1 &lt; t1, t1 &lt; t2, t2 &lt; t1</span>
<span class="sd">    (False, True, False)</span>
<span class="sd">    &gt;&gt;&gt; t1 &lt;= t1, t1 &lt;= t2, t2 &lt;= t1</span>
<span class="sd">    (True, True, False)</span>
<span class="sd">    &gt;&gt;&gt; t1 == t1, t1 == t2, t1 == 1</span>
<span class="sd">    (True, False, False)</span>
<span class="sd">    &gt;&gt;&gt; t1 != t1, t1 != t2, t1 != 1</span>
<span class="sd">    (False, True, True)</span>
<span class="sd">    &gt;&gt;&gt; t1 &gt;= t1, t1 &gt;= t2, t2 &gt;= t1</span>
<span class="sd">    (True, False, True)</span>
<span class="sd">    &gt;&gt;&gt; t1 &gt; t1, t1 &gt; t2, t2 &gt; t1</span>
<span class="sd">    (False, False, True)</span>

<span class="sd">    Subtracting two |TOY| object gives their time difference in seconds:</span>

<span class="sd">    &gt;&gt;&gt; TOY(&#39;1_1_0_3_0&#39;) - TOY(&#39;1_1_0_1_30&#39;)</span>
<span class="sd">    90</span>

<span class="sd">    Subtraction never results in negative values, due to assuming the</span>
<span class="sd">    left operand is the posterior (eventually within the subsequent year):</span>

<span class="sd">    &gt;&gt;&gt; TOY(&#39;1_1_0_1_30&#39;) - TOY(&#39;12_31_23_58_30&#39;)</span>
<span class="sd">    180</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_PROPERTIES</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(((</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)),</span>
                                           <span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)),</span>
                                           <span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">)),</span>
                                           <span class="p">(</span><span class="s1">&#39;minute&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">59</span><span class="p">)),</span>
                                           <span class="p">(</span><span class="s1">&#39;second&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">59</span><span class="p">))))</span>
    <span class="n">_STARTDATE</span> <span class="o">=</span> <span class="n">Date</span><span class="o">.</span><span class="n">from_datetime</span><span class="p">(</span><span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">_ENDDATE</span> <span class="o">=</span> <span class="n">Date</span><span class="o">.</span><span class="n">from_datetime</span><span class="p">(</span><span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">month</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">day</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">hour</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">minute</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">second</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Date</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Date</span><span class="p">):</span>
                <span class="n">datetime</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">datetime</span>
                <span class="n">dict_</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROPERTIES</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dict_</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">datetime</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                    <span class="k">del</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROPERTIES</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">prop</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">):</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                            <span class="n">f</span><span class="s1">&#39;While trying to retrieve the </span><span class="si">{prop}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;seconds_passed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;seconds_left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to initialise a TOY object based on &#39;</span>
                <span class="n">f</span><span class="s1">&#39;argument `{objecttools.value_of_type(value)}&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROPERTIES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;TOY (time of year) objects only allow to set the &#39;</span>
                <span class="n">f</span><span class="s1">&#39;properties {objecttools.enumeration(self._PROPERTIES.keys())}&#39;</span>
                <span class="n">f</span><span class="s1">&#39;, but `</span><span class="si">{name}</span><span class="s1">` is given.&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;For TOY (time of year) objects, all properties must be of &#39;</span>
                <span class="n">f</span><span class="s1">&#39;type `int`, but the {objecttools.value_of_type(value)} &#39;</span>
                <span class="n">f</span><span class="s1">&#39;given for property `</span><span class="si">{name}</span><span class="s1">` cannot be converted to `int`.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;day&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">):</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">calendar</span><span class="o">.</span><span class="n">monthrange</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="n">f</span><span class="s1">&#39;The value of property `day` of the actual TOY &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;(time of year) object must lie within the range &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;`</span><span class="si">{bounds}</span><span class="s1">`, as the month has already been set to &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;`</span><span class="si">{self.month}</span><span class="s1">`, but the given value is `</span><span class="si">{value}</span><span class="s1">`.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;month&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">):</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">calendar</span><span class="o">.</span><span class="n">monthrange</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">value</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="n">f</span><span class="s1">&#39;The value of property `month` of the actual TOY &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;(time of year) object must not be the given value &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;`</span><span class="si">{value}</span><span class="s1">`, as the day has already been set to &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;`</span><span class="si">{self.day}</span><span class="s1">`.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROPERTIES</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="n">f</span><span class="s1">&#39;The value of property `</span><span class="si">{name}</span><span class="s1">` of TOY (time of &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;year) objects must lie within the range `</span><span class="si">{bounds}</span><span class="s1">`, &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;but the given value is `</span><span class="si">{value}</span><span class="s1">`.&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;seconds_passed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;seconds_left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">seconds_passed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The amount of time passed in seconds since the beginning of the year.</span>

<span class="sd">        In the first example, the year is only one minute and thirty seconds</span>
<span class="sd">        old:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.timetools import TOY</span>
<span class="sd">        &gt;&gt;&gt; toy = TOY(&#39;1_1_0_1_30&#39;)</span>
<span class="sd">        &gt;&gt;&gt; toy.seconds_passed</span>
<span class="sd">        90</span>

<span class="sd">        Updating the |TOY| object triggers a recalculation of property</span>
<span class="sd">        |TOY.seconds_passed|:</span>

<span class="sd">        &gt;&gt;&gt; toy.day = 2</span>
<span class="sd">        &gt;&gt;&gt; toy.seconds_passed</span>
<span class="sd">        86490</span>

<span class="sd">        The second example shows the general inclusion of the 29th of February:</span>

<span class="sd">        &gt;&gt;&gt; TOY(&#39;3&#39;).seconds_passed</span>
<span class="sd">        5184000</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">seconds_passed</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;seconds_passed&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">seconds_passed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">seconds_passed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_datetime</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_STARTDATE</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;seconds_passed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seconds_passed</span>
        <span class="k">return</span> <span class="n">seconds_passed</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">seconds_left</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The remaining amount of time part of the year in seconds.</span>

<span class="sd">        In the first example, only one minute and thirty seconds of the year</span>
<span class="sd">        remain:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.timetools import TOY</span>
<span class="sd">        &gt;&gt;&gt; toy = TOY(&#39;12_31_23_58_30&#39;)</span>
<span class="sd">        &gt;&gt;&gt; toy.seconds_left</span>
<span class="sd">        90</span>

<span class="sd">        Updating the |TOY| object triggers a recalculation of property</span>
<span class="sd">        |TOY.seconds_passed|:</span>

<span class="sd">        &gt;&gt;&gt; toy.day = 30</span>
<span class="sd">        &gt;&gt;&gt; toy.seconds_left</span>
<span class="sd">        86490</span>

<span class="sd">        The second example shows the general inclusion of the 29th of February:</span>

<span class="sd">        &gt;&gt;&gt; TOY(&#39;2&#39;).seconds_left</span>
<span class="sd">        28944000</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">seconds_left</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;seconds_left&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">seconds_left</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">seconds_left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ENDDATE</span><span class="o">.</span><span class="n">datetime</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_datetime</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;seconds_left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seconds_left</span>
        <span class="k">return</span> <span class="n">seconds_left</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">datetime_</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span>
            <span class="mi">2000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>

<div class="viewcode-block" id="TOY.centred_timegrid"><a class="viewcode-back" href="../../../timetools.html#hydpy.core.timetools.TOY.centred_timegrid">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">centred_timegrid</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Timegrid</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a |Timegrid| object defining the central time points</span>
<span class="sd">        of the year 2000 and a boolean array describing its intersection</span>
<span class="sd">        with the current initialisation period not taking the year</span>
<span class="sd">        information into account.</span>

<span class="sd">        The returned |Timegrid| object does not depend on the defined</span>
<span class="sd">        initialisation period at all:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.timetools import TOY</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2001-10-01&#39;, &#39;2010-10-01&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; TOY.centred_timegrid()[0]</span>
<span class="sd">        Timegrid(&#39;2000-01-01 12:00:00&#39;,</span>
<span class="sd">                 &#39;2001-01-01 12:00:00&#39;,</span>
<span class="sd">                 &#39;1d&#39;)</span>

<span class="sd">        The same holds for the shape of the returned boolean array:</span>

<span class="sd">        &gt;&gt;&gt; len(TOY.centred_timegrid()[1])</span>
<span class="sd">        366</span>

<span class="sd">        However, the single boolean values depend on whether the respective</span>
<span class="sd">        centred date lies at least one time within the initialisation period</span>
<span class="sd">        when ignoring the year information.  In our example, all centred dates</span>
<span class="sd">        are &quot;relevant&quot; due to the long initialisation period of ten years:</span>

<span class="sd">        &gt;&gt;&gt; sum(TOY.centred_timegrid()[1])</span>
<span class="sd">        366</span>

<span class="sd">        The boolean array contains only the value |True| for all</span>
<span class="sd">        initialisation periods covering at least a full year:</span>

<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2000-02-01&#39;, &#39;2001-02-01&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; sum(TOY.centred_timegrid()[1])</span>
<span class="sd">        366</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2001-10-01&#39;, &#39;2002-10-01&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; sum(TOY.centred_timegrid()[1])</span>
<span class="sd">        366</span>

<span class="sd">        In all other cases, only the values related to the intersection</span>
<span class="sd">        are |True|:</span>

<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2001-01-03&#39;, &#39;2001-01-05&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; TOY.centred_timegrid()[1][:5]</span>
<span class="sd">        array([False, False,  True,  True, False], dtype=bool)</span>

<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2001-12-30&#39;, &#39;2002-01-04&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; TOY.centred_timegrid()[1][:5]</span>
<span class="sd">        array([ True,  True,  True, False, False], dtype=bool)</span>
<span class="sd">        &gt;&gt;&gt; TOY.centred_timegrid()[1][-5:]</span>
<span class="sd">        array([False, False, False,  True,  True], dtype=bool)</span>

<span class="sd">        It makes no difference whether initialisation periods not spanning</span>
<span class="sd">        a full year contain the 29th of February or not:</span>

<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2001-02-27&#39;, &#39;2001-03-01&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; TOY.centred_timegrid()[1][31+28-3-1:31+28+3-1]</span>
<span class="sd">        array([False, False,  True,  True,  True, False], dtype=bool)</span>
<span class="sd">        &gt;&gt;&gt; pub.timegrids = &#39;2000-02-27&#39;, &#39;2000-03-01&#39;, &#39;1d&#39;</span>
<span class="sd">        &gt;&gt;&gt; TOY.centred_timegrid()[1][31+28-3-1:31+28+3-1]</span>
<span class="sd">        array([False, False,  True,  True,  True, False], dtype=bool)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">init</span> <span class="o">=</span> <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">init</span><span class="o">.</span><span class="n">stepsize</span><span class="o">/</span><span class="mf">2.</span>
        <span class="n">centred</span> <span class="o">=</span> <span class="n">Timegrid</span><span class="p">(</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_STARTDATE</span><span class="o">+</span><span class="n">shift</span><span class="p">,</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_ENDDATE</span><span class="o">+</span><span class="n">shift</span><span class="p">,</span>
            <span class="n">init</span><span class="o">.</span><span class="n">stepsize</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">init</span><span class="o">.</span><span class="n">lastdate</span><span class="o">-</span><span class="n">init</span><span class="o">.</span><span class="n">firstdate</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="s1">&#39;365d&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">centred</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centred</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">date0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">init</span><span class="o">.</span><span class="n">firstdate</span><span class="p">)</span>
        <span class="n">date1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">init</span><span class="o">.</span><span class="n">lastdate</span><span class="p">)</span>
        <span class="n">date0</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="mi">2000</span>
        <span class="n">date1</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="mi">2000</span>
        <span class="n">relevant</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centred</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">date0</span> <span class="o">&lt;</span> <span class="n">date1</span><span class="p">:</span>
            <span class="n">relevant</span><span class="p">[</span><span class="n">centred</span><span class="p">[</span><span class="n">date0</span><span class="o">+</span><span class="n">shift</span><span class="p">]:</span><span class="n">centred</span><span class="p">[</span><span class="n">date1</span><span class="o">+</span><span class="n">shift</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">relevant</span><span class="p">[</span><span class="n">centred</span><span class="p">[</span><span class="n">date0</span><span class="o">+</span><span class="n">shift</span><span class="p">]:]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">relevant</span><span class="p">[:</span><span class="n">centred</span><span class="p">[</span><span class="n">date1</span><span class="o">+</span><span class="n">shift</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">centred</span><span class="p">,</span> <span class="n">relevant</span></div>


    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TOY&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds_passed</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">seconds_passed</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds_passed</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">seconds_left</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TOY&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds_passed</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">seconds_passed</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TOY&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds_passed</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">seconds_passed</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds_passed</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">seconds_passed</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds_passed</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">seconds_passed</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TOY&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds_passed</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">seconds_passed</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TOY&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds_passed</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">seconds_passed</span>

    <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">id</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">))</span> <span class="k">for</span> <span class="n">prop</span>
                          <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROPERTIES</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;toy_</span><span class="si">{string}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;TOY(&#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span> <span class="o">%</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">))</span> <span class="k">for</span> <span class="n">prop</span>
                                      <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PROPERTIES</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../framework.html">Framework Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Example Projects</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 4.0a11 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, HydPy Developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>